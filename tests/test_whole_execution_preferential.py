# -*- coding: utf-8 -*-

import unittest
import interbank
import interbank_lenderchange
import os

class WholeExecution(unittest.TestCase):
    N = 50
    T = 50
    T_LONG = 1000

    maxDiff = None

    ALGORITHM = interbank_lenderchange.Preferential
    M = 25

    SEED = 39393

    RESULTS_TO_COMPARE = '{"bad_debt":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":7.5295017655,"5":15.8396332685,"6":12.0092390911,"7":15.1010677919,"8":40.5548397382,"9":7.4480217684,"10":1.4971181954,"11":20.3695859893,"12":0.0,"13":14.7376337552,"14":4.9686164809,"15":0.0,"16":11.0736343268,"17":27.0221299216,"18":0.0,"19":0.0,"20":4.1371964154,"21":56.7473695208,"22":0.0,"23":0.0,"24":0.0,"25":0.0,"26":9.1221772182,"27":17.7921735931,"28":0.7595230554,"29":28.6408454666,"30":0.0,"31":9.6320256258,"32":0.0,"33":0.0,"34":10.7617357161,"35":0.0,"36":10.7685144224,"37":5.299517503,"38":21.5118540605,"39":24.9213261185,"40":17.6930618549,"41":18.6266113749,"42":0.0,"43":37.3280522121,"44":12.044405475,"45":41.0060126802,"46":27.8695335854,"47":105.01384163,"48":0.0,"49":9.3536096487},"liquidity":{"0":3052.1979474361,"1":2928.0801133594,"2":2877.4414307579,"3":2993.3983632628,"4":3289.489567311,"5":3340.1743102124,"6":3418.8766350927,"7":3427.1130433867,"8":3409.9548168603,"9":3416.9986151223,"10":3614.7137066674,"11":3708.9338517843,"12":4285.0139841908,"13":4524.3433681549,"14":4208.7211841623,"15":4431.0545842132,"16":5170.1422183667,"17":5457.7218357647,"18":5537.2535876542,"19":5911.7667147823,"20":5705.5948412791,"21":5827.6717536876,"22":5748.259076649,"23":6301.1827848421,"24":6698.4991685107,"25":6498.997152172,"26":6679.3493862275,"27":7362.1971386189,"28":7251.6003775816,"29":7524.8477732914,"30":6697.832510947,"31":6858.0054343518,"32":6719.490537208,"33":6386.1579674853,"34":6003.3913235366,"35":5800.1158004943,"36":6191.9895130692,"37":5910.1101213257,"38":6010.7803839249,"39":6165.0638600849,"40":6289.2405667043,"41":7235.3305456841,"42":6957.4707011309,"43":7218.4824065656,"44":7392.2593856274,"45":9044.4258510202,"46":8189.1497316494,"47":8758.8545179243,"48":10498.4015745409,"49":11238.8455328065},"interest_rate":{"0":0.0,"1":0.0,"2":0.0,"3":0.02,"4":0.0005384296,"5":0.014156263,"6":0.0403861369,"7":0.0531322551,"8":0.0434892053,"9":0.0087086377,"10":0.011235358,"11":0.0190370352,"12":0.3406443177,"13":1.7405278792,"14":0.02,"15":0.1447951699,"16":2.6070481452,"17":0.1971331679,"18":0.0,"19":0.2036709965,"20":0.1666676439,"21":0.36057725,"22":0.2579067569,"23":0.0,"24":0.0,"25":0.0,"26":27.3142253658,"27":0.1977022626,"28":0.02,"29":0.1365377045,"30":0.059535953,"31":0.0452380739,"32":0.0701687738,"33":0.0,"34":0.0399249117,"35":0.0,"36":0.1369431277,"37":0.054036383,"38":0.0711063387,"39":3.6984121636,"40":0.0536580181,"41":0.104496212,"42":0.0507789442,"43":0.0947287586,"44":0.1271927135,"45":4.6697981648,"46":0.9157013382,"47":0.1879292071,"48":0.0725249126,"49":0.0675988286},"asset_i":{"0":0.0,"1":2.7280427798,"2":2.6447406811,"3":2.6858547895,"4":2.7617919187,"5":2.8733323621,"6":2.6435467926,"7":2.8037523357,"8":2.6915265328,"9":2.888124521,"10":2.810972148,"11":2.8524327577,"12":3.0475946445,"13":2.8824535206,"14":2.6219878268,"15":2.6919019348,"16":3.1720942499,"17":3.5527782396,"18":3.3157412386,"19":3.4763931169,"20":3.3821047171,"21":3.9102690978,"22":3.5022588627,"23":3.5224562514,"24":3.3384339541,"25":3.6647173125,"26":4.0359440937,"27":4.0152195767,"28":3.8506525023,"29":4.0015750455,"30":3.339315008,"31":3.4288754008,"32":3.4944210912,"33":3.0227263108,"34":3.1551306099,"35":3.009600174,"36":3.3473964254,"37":3.3431144792,"38":3.7534533382,"39":4.1388412031,"40":3.1235101167,"41":3.9789100633,"42":3.4853640039,"43":3.663230225,"44":3.7578049351,"45":5.3453570415,"46":4.62807318,"47":3.9720302284,"48":4.3041002496,"49":5.7796260744},"asset_j":{"0":0.0,"1":4.526357131,"2":4.4633378582,"3":4.4397833141,"4":4.4410831556,"5":4.667533984,"6":4.6394600825,"7":4.7366823256,"8":4.7358203163,"9":4.8459575257,"10":4.7971267388,"11":4.8908655783,"12":4.9622324551,"13":5.2571766169,"14":5.6459983552,"15":5.4042704088,"16":5.470387343,"17":5.9173985147,"18":6.0166149904,"19":6.1165484499,"20":6.2312967532,"21":6.2226580297,"22":6.2569367594,"23":6.146296788,"24":6.4745037211,"25":6.6881189892,"26":6.615890686,"27":6.6975204093,"28":6.9923632084,"29":7.0081156637,"30":7.0910319307,"31":6.687208662,"32":6.7909055768,"33":6.705089827,"34":6.6146709466,"35":6.3293740704,"36":6.3004029053,"37":6.442097593,"38":6.3932796182,"39":6.3940354093,"40":6.5057587726,"41":6.6249626515,"42":7.0554919872,"43":6.8654673715,"44":7.0385764696,"45":7.1958746151,"46":8.0192284095,"47":7.4532094663,"48":7.7673914575,"49":8.6842123227},"equity":{"0":750.0,"1":750.0,"2":750.0,"3":750.0,"4":729.3614348714,"5":724.8227688867,"6":707.5344379627,"7":674.0647529146,"8":640.6520621176,"9":633.2040403492,"10":631.7069221537,"11":610.7570393199,"12":594.3266448501,"13":585.7824725885,"14":601.7708343809,"15":601.7708343809,"16":602.6788542004,"17":570.2131332476,"18":579.8243670844,"19":574.5460520982,"20":564.2483243861,"21":515.0575492137,"22":520.8024698134,"23":513.9895808798,"24":506.8818011301,"25":494.0520335689,"26":512.2891139373,"27":469.5653532072,"28":477.9339676102,"29":449.2931221436,"30":455.0801283721,"31":417.8744146352,"32":404.300279989,"33":407.2481312156,"34":423.2073767239,"35":449.3623452566,"36":426.9818623834,"37":421.6823448805,"38":411.222723011,"39":401.3340035087,"40":392.0550678512,"41":401.0388241489,"42":412.8516262002,"43":365.512492636,"44":322.3753534431,"45":320.2607220441,"46":433.0277344584,"47":414.236789539,"48":405.5569807057,"49":383.2266226282},"equity_borrowers":{"0":0.0,"1":0.0,"2":0.0,"3":14.9796146602,"4":0.0,"5":14.908686398,"6":24.18358849,"7":18.4364434259,"8":0.0,"9":14.9842236634,"10":14.8955138184,"11":14.9693531773,"12":4.4504272223,"13":3.4619865012,"14":0.0,"15":13.6829928018,"16":0.0,"17":9.4399629026,"18":0.0,"19":7.5509764576,"20":0.0,"21":14.9726867333,"22":14.4247533093,"23":0.0,"24":0.0,"25":0.0,"26":0.0,"27":0.603951353,"28":0.0,"29":14.4252091391,"30":29.3571235413,"31":1.0436928636,"32":14.9170034309,"33":0.0,"34":14.3819960161,"35":0.0,"36":1.0037218445,"37":0.0,"38":7.2500138818,"39":0.0,"40":0.0,"41":0.0,"42":14.962170889,"43":0.0,"44":24.2663901539,"45":14.5583998669,"46":29.4490356719,"47":29.1563049472,"48":28.6522826698,"49":13.6016989657},"bankruptcies":{"0":0,"1":1,"2":0,"3":1,"4":2,"5":5,"6":1,"7":4,"8":6,"9":2,"10":1,"11":8,"12":0,"13":3,"14":4,"15":1,"16":4,"17":3,"18":3,"19":0,"20":4,"21":7,"22":5,"23":0,"24":1,"25":1,"26":4,"27":1,"28":2,"29":1,"30":1,"31":4,"32":1,"33":1,"34":1,"35":3,"36":2,"37":2,"38":2,"39":5,"40":6,"41":6,"42":1,"43":4,"44":5,"45":7,"46":2,"47":10,"48":1,"49":2},"potential_credit_channels":{"0":50,"1":50,"2":50,"3":50,"4":50,"5":50,"6":50,"7":50,"8":50,"9":50,"10":50,"11":50,"12":50,"13":50,"14":50,"15":50,"16":50,"17":50,"18":50,"19":50,"20":50,"21":50,"22":50,"23":50,"24":50,"25":50,"26":50,"27":50,"28":50,"29":50,"30":50,"31":50,"32":50,"33":50,"34":50,"35":50,"36":50,"37":50,"38":50,"39":50,"40":50,"41":50,"42":50,"43":50,"44":50,"45":50,"46":50,"47":50,"48":50,"49":50},"prob_change_lender":{"0":0.5197481744,"1":0.5008938328,"2":0.4553928682,"3":0.4033935354,"4":0.3566350229,"5":0.3468230354,"6":0.3691965931,"7":0.3432368323,"8":0.3281073137,"9":0.2997026188,"10":0.307285677,"11":0.3151011987,"12":0.2984236396,"13":0.2294409194,"14":0.1939885086,"15":0.2376187835,"16":0.1947934142,"17":0.2053650785,"18":0.2061734974,"19":0.2322895161,"20":0.2136588626,"21":0.237364463,"22":0.2836910001,"23":0.2511438902,"24":0.2138522251,"25":0.2125467101,"26":0.2206648816,"27":0.2090714363,"28":0.1902036443,"29":0.228841619,"30":0.2037506563,"31":0.2204299646,"32":0.2384078455,"33":0.2416620158,"34":0.2183552447,"35":0.2204013621,"36":0.2018058064,"37":0.2025052632,"38":0.2572429598,"39":0.2942931764,"40":0.3294772706,"41":0.3390238515,"42":0.3638901694,"43":0.3429375863,"44":0.3137580372,"45":0.3175353756,"46":0.3215467557,"47":0.3465349441,"48":0.3789548613,"49":0.3658588909},"best_lender":{"0":38,"1":33,"2":29,"3":27,"4":27,"5":27,"6":27,"7":0,"8":48,"9":45,"10":27,"11":27,"12":27,"13":27,"14":27,"15":27,"16":27,"17":27,"18":27,"19":27,"20":27,"21":27,"22":27,"23":27,"24":27,"25":27,"26":27,"27":27,"28":27,"29":27,"30":27,"31":27,"32":27,"33":27,"34":27,"35":27,"36":27,"37":27,"38":27,"39":27,"40":27,"41":27,"42":27,"43":42,"44":42,"45":41,"46":41,"47":42,"48":42,"49":41},"policy":{"0":1.0,"1":1.0,"2":1.0,"3":1.0,"4":1.0,"5":1.0,"6":1.0,"7":1.0,"8":1.0,"9":1.0,"10":1.0,"11":1.0,"12":1.0,"13":1.0,"14":1.0,"15":1.0,"16":1.0,"17":1.0,"18":1.0,"19":1.0,"20":1.0,"21":1.0,"22":1.0,"23":1.0,"24":1.0,"25":1.0,"26":1.0,"27":1.0,"28":1.0,"29":1.0,"30":1.0,"31":1.0,"32":1.0,"33":1.0,"34":1.0,"35":1.0,"36":1.0,"37":1.0,"38":1.0,"39":1.0,"40":1.0,"41":1.0,"42":1.0,"43":1.0,"44":1.0,"45":1.0,"46":1.0,"47":1.0,"48":1.0,"49":1.0},"fitness":{"0":0.0,"1":0.5371630566,"2":0.3305320437,"3":0.2904811671,"4":0.2248581495,"5":0.2642976881,"6":0.2400940494,"7":0.1629322082,"8":0.1508455482,"9":0.3146398546,"10":0.3326882018,"11":0.233287455,"12":0.194982841,"13":0.1335519723,"14":0.2088587873,"15":0.2106603694,"16":0.2053678281,"17":0.2045494658,"18":0.1805291613,"19":0.1975604634,"20":0.1411461002,"21":0.1543481797,"22":0.1473008306,"23":0.1548576199,"24":0.1451547311,"25":0.169263765,"26":0.2439905271,"27":0.2182635619,"28":0.185448587,"29":0.179293011,"30":0.1197194757,"31":0.1562493449,"32":0.1071282282,"33":0.1257925032,"34":0.1392800146,"35":0.1750851034,"36":0.221076352,"37":0.1916397261,"38":0.2042892094,"39":0.154656531,"40":0.123763053,"41":0.165627525,"42":0.1373190115,"43":0.1406822297,"44":0.10408937,"45":0.1101515203,"46":0.0903323765,"47":0.1117070911,"48":0.0943409802,"49":0.0732244439},"best_lender_clients":{"0":4,"1":6,"2":8,"3":6,"4":7,"5":5,"6":7,"7":5,"8":5,"9":5,"10":7,"11":12,"12":13,"13":13,"14":15,"15":14,"16":17,"17":17,"18":16,"19":18,"20":20,"21":17,"22":20,"23":22,"24":22,"25":22,"26":22,"27":24,"28":25,"29":24,"30":26,"31":25,"32":25,"33":25,"34":25,"35":24,"36":23,"37":24,"38":22,"39":20,"40":20,"41":15,"42":12,"43":9,"44":9,"45":8,"46":8,"47":7,"48":9,"49":10},"rationing":{"0":0.0,"1":6.4409382259,"2":0.0,"3":11.4369504155,"4":5.6181700128,"5":4.650097061,"6":0.8043523243,"7":11.3173417882,"8":10.9617232395,"9":0.0,"10":0.0,"11":35.4865262239,"12":5.2073185869,"13":0.0,"14":18.3828752658,"15":20.3866504864,"16":20.2354391751,"17":12.3747587496,"18":24.3387961325,"19":0.0,"20":33.5408300878,"21":26.2927042518,"22":45.7451015173,"23":2.5572330735,"24":29.0995202649,"25":13.9875483845,"26":20.4528409851,"27":0.0,"28":9.4423613698,"29":0.0,"30":15.1482316289,"31":54.3916316853,"32":15.5034632043,"33":6.7322973856,"34":0.0,"35":20.4574487834,"36":0.0,"37":0.0,"38":8.8512907108,"39":0.0,"40":32.4089725326,"41":13.3810950326,"42":10.5792691303,"43":17.215143448,"44":16.7774162071,"45":48.6952061339,"46":0.0,"47":67.4508518125,"48":9.6716824342,"49":20.857346635},"leverage":{"0":0.0,"1":0.0,"2":0.0,"3":0.0680436054,"4":0.0,"5":0.237875626,"6":0.6328540593,"7":0.7263524592,"8":0.0,"9":0.3518128356,"10":0.2977736994,"11":0.1023652202,"12":1.0280086441,"13":-0.244930514,"14":0.0,"15":0.6647417794,"16":0.0,"17":0.0688035439,"18":0.0,"19":1.4114620753,"20":0.0,"21":0.0119415997,"22":0.1546261754,"23":0.0,"24":0.0,"25":0.0,"26":0.0,"27":7.5829185782,"28":0.0,"29":0.2977228361,"30":0.3744201268,"31":4.3005446792,"32":2.6779756048,"33":0.0,"34":0.6145777539,"35":0.0,"36":5.4989935304,"37":0.0,"38":1.5925768976,"39":0.0,"40":0.0,"41":0.0,"42":0.0497906571,"43":0.0811462791,"44":1.0145853268,"45":0.230653473,"46":0.1550213474,"47":0.1384718264,"48":0.6484893795,"49":0.4770745803},"systemic_leverage":{"0":0.0,"1":0.0,"2":0.0,"3":0.0013608721,"4":0.0,"5":0.0047575125,"6":0.0253141624,"7":0.0435811476,"8":0.0,"9":0.0070362567,"10":0.005955474,"11":0.0020473044,"12":0.0205601729,"13":-0.0097972206,"14":0.0,"15":0.0132948356,"16":0.0,"17":0.0013760709,"18":0.0,"19":0.0282292415,"20":0.0,"21":0.000238832,"22":0.0030925235,"23":0.0,"24":0.0,"25":0.0,"26":0.0,"27":0.3033167431,"28":0.0,"29":0.0059544567,"30":0.0149768051,"31":0.0860108936,"32":0.1071190242,"33":0.0,"34":0.0122915551,"35":0.0,"36":0.1099798706,"37":0.0,"38":0.031851538,"39":0.0,"40":0.0,"41":0.0,"42":0.0009958131,"43":0.0016229256,"44":0.0608751196,"45":0.0046130695,"46":0.0062008539,"47":0.0055388731,"48":0.0259395752,"49":0.0095414916},"loans":{"0":null,"1":null,"2":null,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0,"11":0.0,"12":0.0,"13":0.0,"14":0.0,"15":0.0,"16":0.0,"17":0.0,"18":null,"19":0.0,"20":0.0,"21":0.0,"22":0.0,"23":null,"24":null,"25":null,"26":0.0,"27":0.0,"28":null,"29":0.0,"30":0.0,"31":0.0,"32":0.0,"33":null,"34":0.0,"35":null,"36":0.0,"37":0.0,"38":0.0,"39":0.0,"40":0.0,"41":0.0,"42":0.0,"43":0.0,"44":0.0,"45":0.0,"46":0.0,"47":0.0,"48":0.0,"49":0.0},"reserves":{"0":113.7183254579,"1":112.2995941502,"2":110.9505789598,"3":114.4678056609,"4":120.864724802,"5":124.2415781005,"6":125.9819987161,"7":128.6506244675,"8":131.1377861602,"9":131.9909673575,"10":136.6619179396,"11":141.5878670919,"12":152.6599708982,"13":157.3242407479,"14":153.030649228,"15":157.1008196212,"16":172.9792063327,"17":178.5782355962,"18":181.9540352407,"19":189.6949305694,"20":185.7646889599,"21":192.1642193949,"22":194.2945826229,"23":205.0254990135,"24":213.0318010289,"25":209.914273911,"26":215.3318650263,"27":229.6860188233,"28":228.2341335619,"29":234.0061422083,"30":216.8891279067,"31":220.240087647,"32":217.1270110985,"33":211.1348264028,"34":203.63455431,"35":203.2252991215,"36":211.7024148856,"37":205.688099201,"38":208.8350357281,"39":212.4884559044,"40":215.4417742537,"41":238.3253656845,"42":231.5930909259,"43":237.3393074577,"44":241.0873409539,"45":274.350530534,"46":255.538404434,"47":269.0230731956,"48":303.8761460994,"49":318.2355237646},"deposits":{"0":5685.916272894,"1":5614.9797075096,"2":5547.5289479914,"3":5723.3902830473,"4":6043.2362401016,"5":6212.0789050261,"6":6299.0999358045,"7":6432.5312233772,"8":6556.8893080115,"9":6599.548367877,"10":6833.0958969798,"11":7079.3933545947,"12":7632.9985449103,"13":7866.2120373936,"14":7651.5324613984,"15":7855.0409810616,"16":8648.9603166329,"17":8928.911779811,"18":9097.7017620338,"19":9484.7465284712,"20":9288.2344479962,"21":9608.2109697431,"22":9714.7291311443,"23":10251.2749506762,"24":10651.5900514438,"25":10495.7136955522,"26":10766.5932513147,"27":11484.3009411664,"28":11411.7066780926,"29":11700.3071104153,"30":10844.4563953366,"31":11012.0043823513,"32":10856.350554925,"33":10556.7413201421,"34":10181.7277154988,"35":10161.2649560742,"36":10585.1207442786,"37":10284.4049600486,"38":10441.7517864038,"39":10624.4227952187,"40":10772.0887126828,"41":11916.2682842273,"42":11579.6545462947,"43":11866.9653728872,"44":12054.3670476966,"45":13717.526526702,"46":12776.9202216984,"47":13451.1536597794,"48":15193.8073049697,"49":15911.7761882296},"active_lenders":{"0":0,"1":0,"2":0,"3":1,"4":1,"5":3,"6":3,"7":4,"8":2,"9":2,"10":2,"11":3,"12":1,"13":3,"14":1,"15":1,"16":1,"17":2,"18":0,"19":1,"20":1,"21":4,"22":1,"23":0,"24":0,"25":0,"26":1,"27":3,"28":0,"29":2,"30":2,"31":2,"32":2,"33":0,"34":2,"35":0,"36":1,"37":1,"38":2,"39":2,"40":2,"41":2,"42":1,"43":1,"44":4,"45":2,"46":3,"47":4,"48":1,"49":1},"active_borrowers":{"0":0,"1":0,"2":0,"3":1,"4":1,"5":3,"6":3,"7":5,"8":3,"9":2,"10":2,"11":4,"12":1,"13":4,"14":2,"15":1,"16":2,"17":2,"18":0,"19":1,"20":1,"21":5,"22":1,"23":0,"24":0,"25":0,"26":1,"27":3,"28":1,"29":2,"30":2,"31":2,"32":2,"33":0,"34":2,"35":0,"36":2,"37":1,"38":2,"39":3,"40":2,"41":3,"42":1,"43":3,"44":5,"45":4,"46":4,"47":7,"48":2,"49":2},"prob_bankruptcy":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0013571782,"5":0.001809571,"6":0.0446971111,"7":0.1371200281,"8":0.3538054212,"9":0.0047062968,"10":0.0052296998,"11":0.0069175595,"12":0.3188192079,"13":0.4164126746,"14":1.352184815,"15":0.1771435543,"16":1.8031583806,"17":0.1771435543,"18":0.0,"19":0.1771435543,"20":0.1760252737,"21":0.2747635238,"22":0.0688914993,"23":0.0,"24":0.0,"25":0.0,"26":0.9724890519,"27":0.1528986637,"28":2.0031337152,"29":0.0688914993,"30":0.0688914993,"31":0.0860821327,"32":0.5020527064,"33":0.0,"34":0.9009915493,"35":0.0,"36":0.1302818833,"37":0.0688914993,"38":0.0688914993,"39":0.3799356728,"40":0.0688914993,"41":0.0816788052,"42":0.0688914993,"43":0.1889929384,"44":0.0924010344,"45":0.7611065107,"46":2.2582091847,"47":0.9686587852,"48":0.0688914993,"49":1.1968107097},"num_banks":{"0":50,"1":50,"2":50,"3":50,"4":50,"5":50,"6":50,"7":50,"8":50,"9":50,"10":50,"11":50,"12":50,"13":50,"14":50,"15":50,"16":50,"17":50,"18":50,"19":50,"20":50,"21":50,"22":50,"23":50,"24":50,"25":50,"26":50,"27":50,"28":50,"29":50,"30":50,"31":50,"32":50,"33":50,"34":50,"35":50,"36":50,"37":50,"38":50,"39":50,"40":50,"41":50,"42":50,"43":50,"44":50,"45":50,"46":50,"47":50,"48":50,"49":50},"bankruptcy_rationed":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0}}'

    def setUp(self):
        model = interbank.Model()
        model.log.define_log('ERROR')
        model.config.lender_change = self.ALGORITHM()
        model.config.lender_change.set_parameter("m", self.M)
        model.configure(N=self.N, T=self.T)
        model.initialize(seed=self.SEED)
        model.simulate_full()
        self.generated_now_values = model.finish()

        # we also create a gdt file with a whole execution:
        model.configure(T=self.T_LONG)
        model.statistics.define_output_format('gdt')
        model.initialize(seed=self.SEED, output_directory='tests',
                         export_datafile='test_whole_execution_preferential')
        model.simulate_full(interactive=True)
        model.finish()
        os.remove('tests\\test_whole_execution_preferential_barabasi_pref.json')
        os.remove('tests\\test_whole_execution_preferential_barabasi_pref.png')


    def test_values_after_execution(self):
        self.assertEqual(self.generated_now_values.to_json(), self.RESULTS_TO_COMPARE)


if __name__ == '__main__':
    unittest.main()
