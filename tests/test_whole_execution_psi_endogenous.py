# -*- coding: utf-8 -*-

import unittest
import interbank
import interbank_lenderchange
import os

class WholeExecution(unittest.TestCase):
    N = 50
    T = 50


    ALGORITHM = interbank_lenderchange.ShockedMarket
    P = 0.5

    SEED = 39393

    CONFIG = 'C_i0=30 D_i0=135 E_i0=15 L_i0=120 alfa=0.1 psi_endogenous=True allow_replacement_of_bankrupted=True beta=5 chi=0.0015 mu=0.7 omega=0.55 phi=0.25 psi=0.0 r_i0=0.02 reintroduce_with_median=False reserves=0.02 rho=0.3 xi=0.9 '

    RESULTS_TO_COMPARE = '{"bad_debt":{"0":0.809979206,"1":25.4827931271,"2":0.0,"3":14.9692557902,"4":62.1897047011,"5":4.8173183145,"6":21.7928212692,"7":53.7581439215,"8":34.8452269917,"9":19.5574418252,"10":27.6657651759,"11":51.2575712207,"12":20.6696073642,"13":17.7409919406,"14":41.6540170648,"15":34.3862747594,"16":22.3335991454,"17":50.0142672187,"18":15.8926721494,"19":13.9375911952,"20":2.3443098614,"21":18.0044392569,"22":35.4718449649,"23":8.4052973372,"24":41.989147098,"25":46.7222307613,"26":5.956963544,"27":27.9954721664,"28":29.2765185586,"29":12.2895795954,"30":22.5932173159,"31":0.0,"32":19.5102598299,"33":10.5732057409,"34":4.4303651745,"35":25.4924672435,"36":37.792531495,"37":0.0,"38":7.2612663384,"39":0.0,"40":12.0547280918,"41":41.8914807066,"42":34.2921606588,"43":24.2857688195,"44":6.2763281728,"45":19.7492888693,"46":6.2496926542,"47":27.4670521435,"48":12.7465043191,"49":22.1100807602},"liquidity":{"0":1282.156580603,"1":1624.1247772364,"2":1735.0278285241,"3":1792.8663056293,"4":1688.8211091962,"5":1917.7654260767,"6":1971.541935072,"7":2046.4110996772,"8":2204.8125705936,"9":2120.8514139098,"10":2257.3441598644,"11":2157.5317046373,"12":2350.8928773243,"13":2875.3490851029,"14":2904.5611349835,"15":2457.0637280405,"16":2768.1083707559,"17":2920.3864610045,"18":2991.6705746204,"19":3352.2394015675,"20":2939.0950079599,"21":3094.2916302874,"22":2668.3532553618,"23":2333.7117221148,"24":2354.9180392094,"25":2389.2518953592,"26":2283.4125273329,"27":2262.6435848819,"28":2608.8232226891,"29":2275.1990388208,"30":2569.2327795806,"31":2877.4959981679,"32":3053.9978554363,"33":2708.8507869196,"34":2770.3019644901,"35":2973.2196694214,"36":2891.496691842,"37":2769.0350367216,"38":2525.2090229836,"39":2625.7231500442,"40":2337.0139727525,"41":2144.9216333958,"42":1893.9756621163,"43":1690.0964212213,"44":1624.8430860786,"45":2085.5006631045,"46":2442.5655009779,"47":1996.4312083072,"48":2020.3952357798,"49":2153.2400702545},"interest_rate":{"0":0.02,"1":0.02,"2":0.02,"3":0.02,"4":0.02,"5":0.02,"6":0.02,"7":0.02,"8":0.02,"9":0.02,"10":0.02,"11":0.02,"12":0.02,"13":0.02,"14":0.02,"15":0.02,"16":0.02,"17":0.02,"18":0.02,"19":0.02,"20":0.02,"21":0.02,"22":0.02,"23":0.02,"24":0.02,"25":0.02,"26":0.0,"27":0.02,"28":0.02,"29":0.02,"30":0.02,"31":0.02,"32":0.02,"33":0.02,"34":0.02,"35":0.02,"36":0.02,"37":0.02,"38":0.02,"39":0.02,"40":0.02,"41":0.02,"42":0.02,"43":0.02,"44":0.02,"45":0.02,"46":0.02,"47":0.02,"48":0.02,"49":0.02},"asset_i":{"0":0.0,"1":144.1647603532,"2":118.3830033867,"3":112.7686054586,"4":204.0793687277,"5":146.9387755102,"6":131.7118993375,"7":168.3824032184,"8":177.8386569284,"9":151.0289046338,"10":154.7458317073,"11":186.4622919527,"12":150.0,"13":161.690402108,"14":182.9858923982,"15":363.217212589,"16":179.4590100274,"17":174.4633639878,"18":207.2855762497,"19":287.0889018252,"20":135.7974396605,"21":184.4923655052,"22":130.644586841,"23":212.606747331,"24":158.666514478,"25":168.9078912918,"26":null,"27":182.5440258576,"28":122.9423766193,"29":140.1721205953,"30":187.8957472875,"31":159.9392233837,"32":150.3236855353,"33":152.385089374,"34":214.7228717617,"35":318.638328928,"36":155.014907002,"37":191.542867618,"38":150.2564701922,"39":150.0,"40":168.6659076489,"41":164.502331575,"42":150.3942830584,"43":169.9398902563,"44":207.6729891697,"45":169.2153056297,"46":182.8728896246,"47":153.376133948,"48":153.4925208398,"49":140.299232963},"asset_j":{"0":0.0,"1":151.5888166227,"2":156.950484708,"3":153.1871722959,"4":162.9538938794,"5":158.089974624,"6":161.4909124326,"7":166.0889491307,"8":167.8204250167,"9":165.2324358744,"10":171.6636000292,"11":167.8280791922,"12":172.96340947,"13":176.0200855197,"14":184.2241040756,"15":181.0054694214,"16":177.6732254268,"17":182.5890455199,"18":187.2834284292,"19":186.4843160426,"20":195.0089011627,"21":185.0811854272,"22":172.8436958988,"23":180.7195019948,"24":171.836950618,"25":176.9680551046,"26":176.8095051662,"27":170.2240956606,"28":170.3385136626,"29":178.1832699663,"30":171.459932558,"31":175.5092245899,"32":180.5898876824,"33":184.2352560733,"34":180.2792165931,"35":182.8967239137,"36":186.1747609503,"37":180.5162408354,"38":176.709204535,"39":179.4890565708,"40":174.8715373317,"41":168.7878252142,"42":168.8824441449,"43":160.8395187605,"44":156.5706058992,"45":156.0682256384,"46":165.1731786181,"47":168.4591102853,"48":166.1135784457,"49":162.9255496625},"equity":{"0":701.0670247363,"1":641.5938853852,"2":655.911661428,"3":638.497275991,"4":614.0325481981,"5":610.5173727585,"6":629.5401762995,"7":591.1388732039,"8":591.3669372244,"9":554.0159639625,"10":631.0004925991,"11":563.6967049264,"12":575.0366072257,"13":637.0993190312,"14":656.3786429674,"15":602.1240300561,"16":643.6850202047,"17":651.3838783061,"18":673.4105934027,"19":657.2681865137,"20":665.2911093684,"21":669.0446974119,"22":626.6445183093,"23":653.2015098393,"24":630.9722743736,"25":645.008474819,"26":592.7260241224,"27":558.9435600005,"28":618.5821628243,"29":619.2358510186,"30":585.8221477108,"31":552.8845483203,"32":632.8018161603,"33":579.6099566631,"34":607.4030869069,"35":638.6786209816,"36":608.4974024772,"37":615.8978965138,"38":540.0660615345,"39":626.3542722619,"40":589.6821433123,"41":580.9534049644,"42":551.7007830647,"43":583.7963341007,"44":556.2191235015,"45":583.5456709701,"46":601.5457905711,"47":543.5503466617,"48":545.6131768851,"49":587.7374213865},"equity_borrowers":{"0":15.0,"1":47.0435439156,"2":6.3831229207,"3":6.2760947795,"4":71.5986984225,"5":30.0,"6":60.0,"7":47.6208872466,"8":105.0,"9":30.1758006341,"10":41.4645882921,"11":27.7440972162,"12":15.0,"13":27.546773888,"14":48.0555182643,"15":7.4321377719,"16":56.3671854482,"17":45.0,"18":15.0,"19":15.0,"20":15.0,"21":45.0,"22":35.8694533039,"23":30.0,"24":70.0389920372,"25":66.1951348366,"26":0.0,"27":47.0333762414,"28":38.6314311405,"29":27.7994722915,"30":35.3581689342,"31":18.3537884554,"32":45.1887203629,"33":13.4029021061,"34":15.0,"35":54.0635318585,"36":45.0,"37":25.7541280212,"38":30.0,"39":15.0,"40":23.3332354556,"41":53.0173373328,"42":35.2262398896,"43":58.6325278734,"44":30.0,"45":30.0,"46":45.0,"47":25.0019873506,"48":22.2668640042,"49":53.644822234},"bankruptcies":{"0":7,"1":11,"2":6,"3":10,"4":12,"5":8,"6":8,"7":9,"8":10,"9":12,"10":10,"11":11,"12":12,"13":6,"14":6,"15":10,"16":7,"17":10,"18":5,"19":7,"20":5,"21":5,"22":7,"23":9,"24":14,"25":11,"26":7,"27":11,"28":6,"29":8,"30":8,"31":8,"32":6,"33":7,"34":9,"35":6,"36":9,"37":3,"38":12,"39":3,"40":8,"41":8,"42":10,"43":8,"44":18,"45":9,"46":3,"47":10,"48":8,"49":11},"potential_credit_channels":{"0":20,"1":27,"2":28,"3":29,"4":20,"5":26,"6":20,"7":26,"8":23,"9":27,"10":25,"11":25,"12":24,"13":22,"14":25,"15":25,"16":26,"17":26,"18":28,"19":24,"20":21,"21":29,"22":24,"23":25,"24":23,"25":23,"26":24,"27":25,"28":26,"29":19,"30":23,"31":23,"32":31,"33":24,"34":25,"35":23,"36":27,"37":27,"38":21,"39":21,"40":25,"41":28,"42":29,"43":30,"44":22,"45":29,"46":29,"47":24,"48":25,"49":28},"prob_change_lender":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0,"11":0.0,"12":0.0,"13":0.0,"14":0.0,"15":0.0,"16":0.0,"17":0.0,"18":0.0,"19":0.0,"20":0.0,"21":0.0,"22":0.0,"23":0.0,"24":0.0,"25":0.0,"26":0.0,"27":0.0,"28":0.0,"29":0.0,"30":0.0,"31":0.0,"32":0.0,"33":0.0,"34":0.0,"35":0.0,"36":0.0,"37":0.0,"38":0.0,"39":0.0,"40":0.0,"41":0.0,"42":0.0,"43":0.0,"44":0.0,"45":0.0,"46":0.0,"47":0.0,"48":0.0,"49":0.0},"best_lender":{"0":7,"1":24,"2":10,"3":31,"4":38,"5":37,"6":37,"7":2,"8":29,"9":27,"10":21,"11":33,"12":33,"13":32,"14":17,"15":29,"16":18,"17":10,"18":41,"19":15,"20":22,"21":48,"22":37,"23":5,"24":7,"25":44,"26":39,"27":44,"28":6,"29":23,"30":39,"31":37,"32":22,"33":32,"34":3,"35":35,"36":26,"37":45,"38":45,"39":4,"40":24,"41":25,"42":24,"43":16,"44":16,"45":16,"46":49,"47":49,"48":8,"49":32},"policy":{"0":1.0,"1":1.0,"2":1.0,"3":1.0,"4":1.0,"5":1.0,"6":1.0,"7":1.0,"8":1.0,"9":1.0,"10":1.0,"11":1.0,"12":1.0,"13":1.0,"14":1.0,"15":1.0,"16":1.0,"17":1.0,"18":1.0,"19":1.0,"20":1.0,"21":1.0,"22":1.0,"23":1.0,"24":1.0,"25":1.0,"26":1.0,"27":1.0,"28":1.0,"29":1.0,"30":1.0,"31":1.0,"32":1.0,"33":1.0,"34":1.0,"35":1.0,"36":1.0,"37":1.0,"38":1.0,"39":1.0,"40":1.0,"41":1.0,"42":1.0,"43":1.0,"44":1.0,"45":1.0,"46":1.0,"47":1.0,"48":1.0,"49":1.0},"fitness":{"0":0.0,"1":0.3712828655,"2":0.2555308521,"3":0.2792849572,"4":0.2178751207,"5":0.2096993722,"6":0.152066624,"7":0.2817249397,"8":0.2562957496,"9":0.2706799797,"10":0.2497084152,"11":0.1855758445,"12":0.1291827619,"13":0.1566395955,"14":0.1647196118,"15":0.1373077643,"16":0.2056003556,"17":0.2259512561,"18":0.2661460043,"19":0.2743386427,"20":0.2642258906,"21":0.2101414106,"22":0.1595620173,"23":0.1829699164,"24":0.1509203173,"25":0.2443195543,"26":0.2363920674,"27":0.270664611,"28":0.1554414496,"29":0.1160574272,"30":0.1144674665,"31":0.0925215152,"32":0.0829314161,"33":0.119836873,"34":0.107036434,"35":0.0965630846,"36":0.0817393475,"37":0.1102505878,"38":0.2060420068,"39":0.202698233,"40":0.3566965111,"41":0.3356565482,"42":0.239024136,"43":0.1820857152,"44":0.2690232899,"45":0.3349056139,"46":0.2768755784,"47":0.2598603514,"48":0.2792025579,"49":0.3535178175},"best_lender_clients":{"0":2,"1":3,"2":4,"3":3,"4":4,"5":3,"6":3,"7":4,"8":3,"9":4,"10":4,"11":5,"12":4,"13":4,"14":3,"15":3,"16":3,"17":4,"18":4,"19":3,"20":4,"21":4,"22":5,"23":5,"24":4,"25":4,"26":4,"27":4,"28":6,"29":4,"30":3,"31":3,"32":4,"33":4,"34":3,"35":4,"36":3,"37":4,"38":4,"39":4,"40":4,"41":3,"42":5,"43":4,"44":4,"45":4,"46":3,"47":3,"48":4,"49":4},"rationing":{"0":26.6145449151,"1":65.7918412973,"2":28.1632191949,"3":52.1288581814,"4":56.6802542579,"5":14.6475222248,"6":13.4563616455,"7":46.0614955829,"8":28.4403709751,"9":71.0584173344,"10":24.9220766098,"11":49.6779437769,"12":73.5936578114,"13":45.921557041,"14":15.7202031568,"15":39.8113170218,"16":26.6780489631,"17":24.6180455895,"18":0.5580928955,"19":34.6539441205,"20":23.2894806595,"21":18.3425773663,"22":29.5241943879,"23":26.1361198531,"24":45.8405179385,"25":16.2322983112,"26":37.9265981842,"27":64.1232904903,"28":8.5166484753,"29":31.8369745253,"30":32.59866454,"31":73.3567573578,"32":9.2530568288,"33":57.6005797666,"34":12.1076921719,"35":27.9354894201,"36":39.3385404319,"37":26.4262747781,"38":85.4774145532,"39":14.557519411,"40":0.0,"41":7.1785179119,"42":48.5847043682,"43":17.5667823068,"44":45.7672990145,"45":52.8107142713,"46":5.4500111812,"47":54.9009831422,"48":52.9604445452,"49":9.5089075702},"leverage":{"0":0.0011489067,"1":0.057595654,"2":0.0077556624,"3":0.0433891472,"4":0.0817573806,"5":0.0127391764,"6":0.4587662363,"7":0.0228039841,"8":0.0383127483,"9":0.0,"10":0.036139343,"11":0.2402898411,"12":0.0306216405,"13":0.0482410283,"14":0.0599820718,"15":0.034919705,"16":0.0247038108,"17":0.1121338625,"18":0.0432453664,"19":0.0,"20":0.0,"21":0.0763633258,"22":0.2363589458,"23":0.3517295499,"24":0.0683694114,"25":0.0800660526,"26":0.0,"27":0.0825419211,"28":0.1539202612,"29":0.0178109849,"30":0.0965433385,"31":0.017357888,"32":0.2509528838,"33":0.0,"34":0.006153285,"35":0.0538033925,"36":0.6459639885,"37":0.0730199802,"38":0.0005564464,"39":0.0,"40":0.0481893932,"41":0.0799878517,"42":0.0493637838,"43":0.2282173736,"44":0.0348858979,"45":0.033821248,"46":0.2260081369,"47":0.6878510553,"48":0.0414476761,"49":0.122163128},"systemic_leverage":{"0":0.0010799723,"1":0.0495322624,"2":0.0071352094,"3":0.0399180154,"4":0.0670410521,"5":0.0117200423,"6":0.4128896127,"7":0.0191553466,"8":0.0306501987,"9":0.0,"10":0.0325254087,"11":0.2066492634,"12":0.0275594765,"13":0.044381746,"14":0.0539838646,"15":0.0314277345,"16":0.0217393535,"17":0.1031631535,"18":0.0423804591,"19":0.0,"20":0.0,"21":0.0702542598,"22":0.2079958723,"23":0.3235911859,"24":0.0574303056,"25":0.0704581263,"26":0.0,"27":0.0676843753,"28":0.1416066403,"29":0.0163861061,"30":0.0830272711,"31":0.0149277837,"32":0.2258575954,"33":0.0,"34":0.0059071536,"35":0.0484230533,"36":0.5813675896,"37":0.0671783818,"38":0.000467415,"39":0.0,"40":0.0462618175,"41":0.0703893095,"42":0.0414655784,"43":0.2008312888,"44":0.0306995901,"45":0.0304391232,"46":0.2124476487,"47":0.6190659498,"48":0.036473955,"49":0.1099468152},"num_of_rationed":{"0":6,"1":8,"2":3,"3":5,"4":6,"5":2,"6":1,"7":5,"8":4,"9":5,"10":3,"11":9,"12":6,"13":5,"14":2,"15":5,"16":3,"17":4,"18":1,"19":2,"20":4,"21":1,"22":3,"23":4,"24":4,"25":2,"26":5,"27":6,"28":3,"29":3,"30":4,"31":7,"32":1,"33":5,"34":2,"35":1,"36":3,"37":3,"38":9,"39":1,"40":0,"41":1,"42":5,"43":2,"44":6,"45":5,"46":1,"47":4,"48":6,"49":2},"loans":{"0":0.809979206,"1":10.3098158863,"2":5.3514070574,"3":14.9692557902,"4":13.0328402492,"5":6.8036750096,"6":9.8024783863,"7":13.4395359804,"8":9.8032834869,"9":11.0877021445,"10":15.4646370282,"11":12.4144521226,"12":20.6696073642,"13":8.8704959703,"14":12.2362154092,"15":17.1931373797,"16":6.9870128847,"17":16.6714224062,"18":15.8926721494,"19":13.9375911952,"20":2.3443098614,"21":13.2721381124,"22":11.2940866036,"23":7.4287501884,"24":8.3978294196,"25":10.5358388611,"26":null,"27":10.6410496,"28":9.7588395195,"29":8.6361514113,"30":8.4804681417,"31":4.7430615201,"32":9.2249348412,"33":11.4833652132,"34":4.4303651745,"35":7.48364995,"36":16.6034701864,"37":5.063778425,"38":1.2690155029,"39":4.4850023831,"40":7.6589101648,"41":8.854418901,"42":13.1204510575,"43":11.4098166329,"44":8.9220677307,"45":10.073473225,"46":9.5206260306,"47":13.7335260718,"48":5.1920729231,"49":8.7310456861},"c":{"0":148.1983620516,"1":153.1588370802,"2":149.7207310317,"3":159.2634685469,"4":154.7760201415,"5":157.7614384026,"6":162.2184536762,"7":163.874340476,"8":161.2318713527,"9":167.3497796344,"10":161.7736747203,"11":168.7972130007,"12":171.789074848,"13":179.5216791944,"14":176.372070259,"15":173.3273040183,"16":178.1137771975,"17":182.7257683117,"18":181.7672533577,"19":190.0223893767,"20":180.3409462928,"21":168.715207851,"22":176.4211523169,"23":167.2106722212,"24":172.6791405748,"25":172.536292082,"26":166.0250764126,"27":166.4183426677,"28":173.8021166405,"29":167.2476456687,"30":170.8377665688,"31":175.8593163511,"32":178.1532549959,"33":175.8633869483,"34":178.3410752117,"35":181.4002358622,"36":174.6962723073,"37":172.3214251736,"38":175.0740605717,"39":170.6626392859,"40":164.7937939148,"41":164.9144373694,"42":157.2471003167,"43":151.9045914749,"44":152.6091893286,"45":161.4576611953,"46":163.061911053,"47":162.1316369,"48":159.23647367,"49":162.8131763278},"reserves":{"0":117.2543328542,"1":112.1795197496,"2":127.134647429,"3":118.6155022235,"4":108.1928208518,"5":125.5994546092,"6":124.4182401681,"7":122.389967139,"8":124.8653790904,"9":119.0865570988,"10":127.6317026012,"11":118.6235335439,"12":126.8658251412,"13":148.0459010815,"14":148.0876906912,"15":129.8946467013,"16":143.3880072789,"17":140.6562982703,"18":153.0329498282,"19":156.2501364589,"20":151.7178813305,"21":154.5545887166,"22":143.3175995146,"23":132.2875956128,"24":122.3912327675,"25":124.390556841,"26":133.7869945984,"27":123.1489277385,"28":141.8648093983,"29":132.4240328941,"30":138.5240727657,"31":145.3344949585,"32":152.1804641012,"33":145.3770899321,"34":142.2108467538,"35":148.0732387599,"36":142.7980385416,"37":154.8356870963,"38":130.1763229261,"39":148.4070083541,"40":131.3053093568,"41":127.2490806312,"42":115.6840835134,"43":115.8935733384,"44":97.1127921655,"45":123.687105484,"46":145.9271067822,"47":120.1001684438,"48":125.3377445703,"49":124.160505221},"deposits":{"0":5862.7166427119,"1":5608.9759874822,"2":6356.7323714503,"3":5930.7751111744,"4":5409.6410425909,"5":6279.9727304588,"6":6220.9120084025,"7":6119.4983569481,"8":6243.2689545181,"9":5954.3278549403,"10":6381.5851300598,"11":5931.1766771952,"12":6343.2912570608,"13":7402.2950540728,"14":7404.3845345603,"15":6494.7323350673,"16":7169.4003639468,"17":7032.8149135151,"18":7651.6474914097,"19":7812.5068229432,"20":7585.8940665245,"21":7727.7294358306,"22":7165.8799757317,"23":6614.3797806395,"24":6119.5616383741,"25":6219.5278420504,"26":6689.3497299191,"27":6157.4463869249,"28":7093.2404699128,"29":6621.2016447069,"30":6926.2036382831,"31":7266.7247479226,"32":7609.0232050593,"33":7268.8544966066,"34":7110.5423376923,"35":7403.6619379973,"36":7139.901927082,"37":7741.7843548154,"38":6508.8161463046,"39":7420.3504177056,"40":6565.2654678383,"41":6362.4540315603,"42":5784.2041756697,"43":5794.6786669176,"44":4855.6396082742,"45":6184.3552742019,"46":7296.3553391098,"47":6005.0084221879,"48":6266.8872285144,"49":6208.0252610507},"psi":{"0":1.0,"1":0.9538680348,"2":0.902085356,"3":0.9264481487,"4":0.9174921732,"5":0.8540231637,"6":0.8494315283,"7":0.8457475862,"8":0.8267835442,"9":0.8226483693,"10":0.8510187037,"11":0.8764069869,"12":0.8606237008,"13":0.9123263924,"14":0.9018342853,"15":0.8575739011,"16":0.891783917,"17":0.9077302492,"18":0.8996170802,"19":0.916357582,"20":0.927249157,"21":0.9120595965,"22":0.8814451146,"23":0.9205619599,"24":0.881425062,"25":0.8565186771,"26":0.8470899065,"27":0.787771962,"28":0.8430584634,"29":0.8590193319,"30":0.8306048644,"31":0.8181886876,"32":0.8538502637,"33":0.8558670814,"34":0.823337389,"35":0.8592970189,"36":0.8342655223,"37":0.8529712602,"38":0.8317994106,"39":0.8425403376,"40":0.7746592072,"41":0.7828976975,"42":0.7776409665,"43":0.8063377651,"44":0.8016832425,"45":0.8356286975,"46":0.8065762201,"47":0.7537400238,"48":0.7539718611,"49":0.7745396824},"psi_lenders":{"0":1.0,"1":1.0,"2":0.224237799,"3":0.2313730084,"4":0.8573685697,"5":1.0,"6":0.7505648818,"7":0.7410835053,"8":0.7040315193,"9":0.9884157259,"10":0.977292446,"11":0.5861984191,"12":0.977292446,"13":0.8047957888,"14":0.933870492,"15":0.9903724644,"16":0.6148035171,"17":0.9903724644,"18":1.0,"19":0.3338263785,"20":1.0,"21":1.0,"22":0.8711690841,"23":0.9961756655,"24":0.8731660422,"25":0.9544657076,"26":0.0,"27":0.6903812811,"28":0.76444286,"29":0.9208423765,"30":0.9914704419,"31":0.9847013217,"32":0.9314274819,"33":0.988554959,"34":0.9837439271,"35":0.8690155992,"36":0.9922860467,"37":0.9852670833,"38":0.1934398558,"39":0.9852670833,"40":0.7461964007,"41":0.8890814648,"42":0.9455844145,"43":0.8152313795,"44":0.9432826874,"45":0.8586529499,"46":0.9898736902,"47":0.9680694751,"48":0.6925436101,"49":0.6425608801},"potential_lenders":{"0":21,"1":21,"2":17,"3":23,"4":21,"5":29,"6":29,"7":25,"8":18,"9":24,"10":21,"11":18,"12":22,"13":27,"14":22,"15":19,"16":25,"17":21,"18":26,"19":29,"20":24,"21":25,"22":24,"23":18,"24":20,"25":26,"26":18,"27":19,"28":23,"29":22,"30":21,"31":21,"32":26,"33":20,"34":23,"35":25,"36":22,"37":25,"38":18,"39":27,"40":26,"41":27,"42":18,"43":24,"44":19,"45":24,"46":28,"47":21,"48":22,"49":25},"active_lenders":{"0":1,"1":3,"2":1,"3":1,"4":5,"5":2,"6":4,"7":4,"8":6,"9":2,"10":3,"11":3,"12":1,"13":2,"14":4,"15":2,"16":4,"17":3,"18":1,"19":1,"20":1,"21":3,"22":3,"23":2,"24":5,"25":5,"26":0,"27":3,"28":3,"29":2,"30":4,"31":2,"32":3,"33":2,"34":1,"35":4,"36":3,"37":2,"38":2,"39":1,"40":2,"41":5,"42":3,"43":4,"44":2,"45":2,"46":3,"47":2,"48":3,"49":3},"active_borrowers":{"0":1,"1":4,"2":1,"3":1,"4":5,"5":2,"6":4,"7":4,"8":7,"9":2,"10":3,"11":3,"12":1,"13":2,"14":4,"15":2,"16":4,"17":3,"18":1,"19":1,"20":1,"21":3,"22":3,"23":2,"24":5,"25":5,"26":0,"27":4,"28":3,"29":2,"30":4,"31":2,"32":4,"33":2,"34":1,"35":4,"36":3,"37":2,"38":2,"39":1,"40":2,"41":5,"42":3,"43":4,"44":2,"45":2,"46":3,"47":2,"48":3,"49":4},"prob_bankruptcy":{"0":0.0,"1":0.0018155515,"2":0.5815936814,"3":0.0,"4":0.0474309505,"5":0.0173764111,"6":0.0226277231,"7":0.0169202596,"8":0.0160979402,"9":0.2296255959,"10":0.3423869555,"11":0.022707554,"12":0.0,"13":0.0,"14":0.2091925164,"15":0.0096275356,"16":0.0714449936,"17":0.0,"18":0.0,"19":0.0,"20":0.0,"21":0.1307721801,"22":0.0973200324,"23":0.1724859834,"24":0.0085295581,"25":0.1439735341,"26":null,"27":0.0098276166,"28":0.0085295581,"29":0.0845483126,"30":0.2048727394,"31":0.4014607495,"32":0.2576739172,"33":0.4119751092,"34":0.0101991189,"35":0.2250454483,"36":0.0199955036,"37":0.160829079,"38":0.2651077019,"39":0.1207352108,"40":0.0168762616,"41":0.1149349543,"42":0.0169526982,"43":0.0217458828,"44":0.1781764721,"45":0.0154505429,"46":0.2228852506,"47":0.0358056379,"48":0.2449026101,"49":0.0406080578},"num_banks":{"0":50,"1":50,"2":50,"3":50,"4":50,"5":50,"6":50,"7":50,"8":50,"9":50,"10":50,"11":50,"12":50,"13":50,"14":50,"15":50,"16":50,"17":50,"18":50,"19":50,"20":50,"21":50,"22":50,"23":50,"24":50,"25":50,"26":50,"27":50,"28":50,"29":50,"30":50,"31":50,"32":50,"33":50,"34":50,"35":50,"36":50,"37":50,"38":50,"39":50,"40":50,"41":50,"42":50,"43":50,"44":50,"45":50,"46":50,"47":50,"48":50,"49":50},"bankruptcy_rationed":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0}}'
    maxDiff = None

    def setUp(self):
        model = interbank.Model()
        model.config.lender_change = self.ALGORITHM()
        model.log.define_log('ERROR')
        model.config.lender_change.set_parameter("p", self.P)
        model.configure_json(self.CONFIG)
        model.configure(N=self.N, T=self.T)
        model.initialize(seed=self.SEED, output_directory='tests',
                         export_datafile='test_whole_execution_shockedmarket')
        model.simulate_full()
        self.generated_now_values = model.finish()
        os.remove('tests\\test_whole_execution_shockedmarket_erdos_renyi.json')
        os.remove('tests\\test_whole_execution_shockedmarket_erdos_renyi.png')


    def test_values_after_execution(self):
        self.assertEqual(self.generated_now_values.to_json(), self.RESULTS_TO_COMPARE)


if __name__ == '__main__':
    unittest.main()
