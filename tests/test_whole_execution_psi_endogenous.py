# -*- coding: utf-8 -*-

import unittest
import interbank
import interbank_lenderchange
import os

class WholeExecution(unittest.TestCase):
    N = 50
    T = 50


    ALGORITHM = interbank_lenderchange.ShockedMarket
    P = 0.5

    SEED = 39393

    CONFIG = 'C_i0=30 D_i0=135 E_i0=15 L_i0=120 alfa=0.1 psi_endogenous=True allow_replacement_of_bankrupted=True beta=5 chi=0.0015 mu=0.7 normalize_interest_rate_max=1 omega=0.55 phi=0.25 psi=0.0 r_i0=0.02 reintroduce_with_median=False reserves=0.02 rho=0.3 xi=0.9 '

    RESULTS_TO_COMPARE = '{"bad_debt":{"0":0.809979206,"1":25.4827931271,"2":0.0,"3":20.2136347065,"4":62.1897047011,"5":4.8173183145,"6":37.8436640841,"7":35.4395672147,"8":41.8232021195,"9":29.7067099856,"10":46.3939110847,"11":7.950347699,"12":20.6696073642,"13":17.7409919406,"14":48.944861637,"15":34.3862747594,"16":22.3335991454,"17":50.0142672187,"18":15.8926721494,"19":13.9375911952,"20":2.3443098614,"21":35.3475670414,"22":41.6608232884,"23":14.8575003768,"24":38.9937438341,"25":44.5067852567,"26":0.0,"27":27.9954721664,"28":35.114604243,"29":12.2895795954,"30":44.6752640283,"31":0.0,"32":20.9701846293,"33":10.5732057409,"34":4.4303651745,"35":40.2005489756,"36":27.6322004237,"37":9.3627494289,"38":0.0,"39":20.8018234768,"40":12.0547280918,"41":28.9646412153,"42":34.2921606588,"43":38.0478845024,"44":6.2763281728,"45":19.7492888693,"46":22.5333534081,"47":31.6109156013,"48":12.7465043191,"49":41.6746830449},"liquidity":{"0":1282.156580603,"1":1618.7870557953,"2":1724.4457281667,"3":1787.5285841882,"4":1683.4833877551,"5":1903.8134735651,"6":1945.3599169161,"7":2005.0329049234,"8":2160.7809478817,"9":2088.9658107539,"10":2184.8526191858,"11":2275.1434647683,"12":2443.5891864366,"13":3009.5780487596,"14":3069.8131348582,"15":2598.7721613137,"16":2920.3561947598,"17":2813.3198695396,"18":2938.7483187614,"19":3507.5158212054,"20":3056.0715175585,"21":3210.0203931066,"22":2772.8714607072,"23":2437.110285165,"24":2332.6842868925,"25":2385.5744554501,"26":2226.4711126482,"27":2234.1223853827,"28":2607.8138809147,"29":2275.2377946545,"30":2575.7945799971,"31":2884.2429947202,"32":3043.1407620401,"33":2774.1906351743,"34":2795.544757044,"35":2107.404739692,"36":2419.1961358939,"37":2530.0094579773,"38":2401.9023654764,"39":2644.3992065829,"40":2407.259991835,"41":2253.0970074167,"42":1938.8894003588,"43":1794.8649583407,"44":1698.1173089373,"45":2119.7686369102,"46":2473.5964939259,"47":2107.2270263018,"48":2027.7718874897,"49":2106.248054842},"interest_rate":{"0":1.0,"1":1.0,"2":1.0,"3":1.0,"4":1.0,"5":1.0,"6":1.0,"7":1.0,"8":1.0,"9":1.0,"10":1.0,"11":1.0,"12":1.0,"13":1.0,"14":1.0,"15":1.0,"16":1.0,"17":1.0,"18":1.0,"19":1.0,"20":1.0,"21":1.0,"22":1.0,"23":1.0,"24":1.0,"25":1.0,"26":0.0,"27":1.0,"28":1.0,"29":1.0,"30":1.0,"31":1.0,"32":1.0,"33":1.0,"34":1.0,"35":1.0,"36":1.0,"37":1.0,"38":1.0,"39":1.0,"40":1.0,"41":1.0,"42":1.0,"43":1.0,"44":1.0,"45":1.0,"46":1.0,"47":1.0,"48":1.0,"49":1.0},"asset_i":{"0":0.0,"1":144.1647603532,"2":118.3830033867,"3":112.7686054586,"4":204.0793687277,"5":146.9387755102,"6":138.2517763722,"7":164.6188006798,"8":177.8386569284,"9":151.0289046338,"10":154.7458317073,"11":189.3576235213,"12":136.8578200141,"13":176.0606466873,"14":184.7429021163,"15":404.1658107187,"16":179.4590100274,"17":188.3857128309,"18":207.2855762497,"19":154.1540774059,"20":135.7974396605,"21":184.4923655052,"22":147.4961273796,"23":212.606747331,"24":163.6690689571,"25":168.9078912918,"26":null,"27":190.7615023755,"28":122.9423766193,"29":140.1721205953,"30":187.8957472875,"31":129.7456721703,"32":157.2527160088,"33":157.8314032379,"34":481.8422032168,"35":312.1355058887,"36":171.3524260072,"37":191.542867618,"38":160.6590097849,"39":150.0,"40":164.8791094549,"41":143.5302265889,"42":142.7872438033,"43":168.0851319572,"44":207.6729891697,"45":169.2153056297,"46":172.8621971734,"47":156.5714700719,"48":137.5658173484,"49":150.9981969509},"asset_j":{"0":0.0,"1":151.5888166227,"2":156.8415516174,"3":152.9890490877,"4":162.8449607887,"5":157.7827417637,"6":161.0462298779,"7":165.9358430092,"8":167.6192839614,"9":165.6127436718,"10":170.5947977412,"11":173.8366516597,"12":174.1969523166,"13":177.4538018321,"14":187.159616604,"15":188.6198573792,"16":181.1075874383,"17":186.1077538227,"18":186.718439774,"19":185.9098383329,"20":198.2115429743,"21":188.0276654886,"22":192.3558328388,"23":183.4312086976,"24":177.8958624891,"25":177.6318697618,"26":176.8784226075,"27":169.682329749,"28":170.2587083915,"29":179.3794715662,"30":172.9994200357,"31":177.2531218092,"32":178.9805011188,"33":184.367047314,"34":181.6328518552,"35":178.3998564164,"36":172.2005626193,"37":171.2036570249,"38":176.7352625098,"39":177.6396894363,"40":178.165568431,"41":170.7858651137,"42":171.2786818774,"43":164.1432854506,"44":159.3756982856,"45":157.3863275278,"46":165.264904564,"47":172.5060018961,"48":167.9960475177,"49":165.6241388236},"equity":{"0":701.0670247363,"1":641.5938853852,"2":655.911661428,"3":638.497275991,"4":614.0325481981,"5":603.7156906591,"6":619.8234875862,"7":555.4256101017,"8":596.9549165588,"9":624.4381687495,"10":618.7564080276,"11":570.4281769375,"12":575.3168828874,"13":619.6369831463,"14":623.1352637663,"15":601.832636175,"16":639.4311153822,"17":647.5841219268,"18":701.5546520522,"19":685.4122451632,"20":669.5049725006,"21":688.2585605441,"22":652.4914770055,"23":661.650083727,"24":649.4945010384,"25":678.2219773296,"26":612.548942913,"27":572.370808171,"28":643.2752696097,"29":639.6512894604,"30":617.1290122393,"31":576.8044891403,"32":642.0879119856,"33":591.0716051751,"34":621.2233643074,"35":621.0124193962,"36":614.3629074311,"37":647.0527765999,"38":594.0927082303,"39":672.539226615,"40":652.2250740535,"41":643.5860357533,"42":589.033743193,"43":651.5913007591,"44":611.1306298367,"45":619.9073187946,"46":624.3342391714,"47":568.5832988642,"48":549.48687407,"49":581.8822415412},"equity_borrowers":{"0":15.0,"1":47.0435439156,"2":6.3831229207,"3":1.0317158633,"4":76.9364198636,"5":30.0,"6":66.2099682953,"7":32.8931842577,"8":106.7625767712,"9":35.6478006588,"10":41.4645882921,"11":15.9857851472,"12":15.0,"13":27.546773888,"14":48.0555182643,"15":7.4321377719,"16":56.3671854482,"17":45.0,"18":15.0,"19":15.0,"20":15.0,"21":45.0,"22":36.9318621087,"23":30.0,"24":54.8229942152,"25":74.3675438852,"26":0.0,"27":47.0333762414,"28":38.6314311405,"29":27.7994722915,"30":44.0012133411,"31":23.5477969604,"32":49.1789921523,"33":10.2227768488,"34":36.398098023,"35":58.9741461834,"36":27.4052910621,"37":18.7491843862,"38":15.0,"39":30.0,"40":23.3332354556,"41":51.9296735823,"42":35.2262398896,"43":58.6325278734,"44":30.0,"45":30.0,"46":60.0,"47":33.9734626669,"48":16.8408503227,"49":59.317739615},"bankruptcies":{"0":7,"1":11,"2":6,"3":10,"4":12,"5":8,"6":9,"7":9,"8":11,"9":11,"10":12,"11":10,"12":11,"13":7,"14":7,"15":9,"16":7,"17":11,"18":5,"19":7,"20":5,"21":6,"22":7,"23":11,"24":14,"25":11,"26":7,"27":11,"28":7,"29":9,"30":9,"31":8,"32":6,"33":7,"34":7,"35":11,"36":9,"37":6,"38":12,"39":5,"40":7,"41":8,"42":12,"43":8,"44":17,"45":8,"46":4,"47":10,"48":8,"49":12},"potential_credit_channels":{"0":20,"1":27,"2":28,"3":29,"4":20,"5":26,"6":20,"7":26,"8":23,"9":27,"10":25,"11":25,"12":24,"13":22,"14":25,"15":25,"16":26,"17":26,"18":28,"19":24,"20":21,"21":29,"22":24,"23":25,"24":23,"25":23,"26":24,"27":25,"28":26,"29":19,"30":23,"31":23,"32":31,"33":24,"34":25,"35":23,"36":27,"37":27,"38":21,"39":21,"40":25,"41":28,"42":29,"43":30,"44":22,"45":29,"46":29,"47":24,"48":25,"49":28},"prob_change_lender":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0,"11":0.0,"12":0.0,"13":0.0,"14":0.0,"15":0.0,"16":0.0,"17":0.0,"18":0.0,"19":0.0,"20":0.0,"21":0.0,"22":0.0,"23":0.0,"24":0.0,"25":0.0,"26":0.0,"27":0.0,"28":0.0,"29":0.0,"30":0.0,"31":0.0,"32":0.0,"33":0.0,"34":0.0,"35":0.0,"36":0.0,"37":0.0,"38":0.0,"39":0.0,"40":0.0,"41":0.0,"42":0.0,"43":0.0,"44":0.0,"45":0.0,"46":0.0,"47":0.0,"48":0.0,"49":0.0},"best_lender":{"0":7,"1":24,"2":10,"3":31,"4":38,"5":37,"6":37,"7":2,"8":29,"9":27,"10":21,"11":33,"12":33,"13":32,"14":17,"15":29,"16":18,"17":10,"18":41,"19":15,"20":22,"21":48,"22":37,"23":5,"24":7,"25":44,"26":39,"27":44,"28":6,"29":23,"30":39,"31":37,"32":22,"33":32,"34":3,"35":35,"36":26,"37":45,"38":45,"39":4,"40":24,"41":25,"42":24,"43":16,"44":16,"45":16,"46":49,"47":49,"48":8,"49":32},"policy":{"0":1.0,"1":1.0,"2":1.0,"3":1.0,"4":1.0,"5":1.0,"6":1.0,"7":1.0,"8":1.0,"9":1.0,"10":1.0,"11":1.0,"12":1.0,"13":1.0,"14":1.0,"15":1.0,"16":1.0,"17":1.0,"18":1.0,"19":1.0,"20":1.0,"21":1.0,"22":1.0,"23":1.0,"24":1.0,"25":1.0,"26":1.0,"27":1.0,"28":1.0,"29":1.0,"30":1.0,"31":1.0,"32":1.0,"33":1.0,"34":1.0,"35":1.0,"36":1.0,"37":1.0,"38":1.0,"39":1.0,"40":1.0,"41":1.0,"42":1.0,"43":1.0,"44":1.0,"45":1.0,"46":1.0,"47":1.0,"48":1.0,"49":1.0},"fitness":{"0":0.0,"1":0.3712828655,"2":0.2548040933,"3":0.2784366519,"4":0.2171969745,"5":0.2091057088,"6":0.1553348229,"7":0.2874107382,"8":0.2644440323,"9":0.2855395238,"10":0.256156452,"11":0.1864044422,"12":0.1318844109,"13":0.1651767007,"14":0.1743116019,"15":0.1436245432,"16":0.2171343874,"17":0.1871088402,"18":0.205404749,"19":0.2290986628,"20":0.2166250233,"21":0.1792084991,"22":0.1335428165,"23":0.1574499561,"24":0.1265904603,"25":0.190032019,"26":0.1819772638,"27":0.2061413994,"28":0.1577196042,"29":0.1196095029,"30":0.1195278163,"31":0.094672735,"32":0.0831496342,"33":0.1194202389,"34":0.1049138229,"35":0.0814014846,"36":0.3369374395,"37":0.355219028,"38":0.3228331284,"39":0.2569359406,"40":0.2414381966,"41":0.3397462389,"42":0.2591375258,"43":0.1949268879,"44":0.281259377,"45":0.33969635,"46":0.2839190117,"47":0.2649874878,"48":0.2943879137,"49":0.3568460682},"best_lender_clients":{"0":2,"1":3,"2":4,"3":3,"4":4,"5":3,"6":3,"7":4,"8":3,"9":4,"10":4,"11":5,"12":4,"13":4,"14":3,"15":3,"16":3,"17":4,"18":4,"19":3,"20":4,"21":4,"22":5,"23":5,"24":4,"25":4,"26":4,"27":4,"28":6,"29":4,"30":3,"31":3,"32":4,"33":4,"34":3,"35":4,"36":3,"37":4,"38":4,"39":4,"40":4,"41":3,"42":5,"43":4,"44":4,"45":4,"46":3,"47":3,"48":4,"49":4},"rationing":{"0":26.6145449151,"1":65.7918412973,"2":28.1632191949,"3":52.1288581814,"4":56.6802542579,"5":14.6475222248,"6":13.4563616455,"7":50.4798064795,"8":28.4403709751,"9":35.2232578094,"10":24.9220766098,"11":50.366908669,"12":78.8293205462,"13":32.2276540227,"14":15.7202031568,"15":29.7417362359,"16":26.6780489631,"17":26.4443145091,"18":0.5580928955,"19":34.6539441205,"20":23.2894806595,"21":0.0,"22":30.8219576448,"23":26.1361198531,"24":45.8405179385,"25":16.6145250137,"26":19.6678135843,"27":64.9554100861,"28":8.5166484753,"29":38.8472816252,"30":29.0583315214,"31":71.3502206148,"32":26.3901257404,"33":57.6005797666,"34":2.242284512,"35":27.9354894201,"36":31.5616867815,"37":26.4262747781,"38":67.0172413992,"39":14.557519411,"40":0.0,"41":7.1785179119,"42":34.5340728482,"43":17.8062614907,"44":49.207896902,"45":53.9345063,"46":10.6860484503,"47":55.2906875713,"48":52.9604445452,"49":8.6812788059},"leverage":{"0":0.0011489067,"1":0.057595654,"2":0.0077556624,"3":0.0585902455,"4":0.0817573806,"5":0.0127391764,"6":0.4691927417,"7":0.0228039841,"8":0.0512232891,"9":0.0,"10":0.0443145574,"11":0.0694139052,"12":0.0306216405,"13":0.0472146234,"14":0.0599820718,"15":0.034160581,"16":0.0247038108,"17":0.1097825336,"18":0.0432453664,"19":0.0,"20":0.0,"21":0.0860124203,"22":0.1066175642,"23":0.3517295499,"24":0.0651750013,"25":0.0665874347,"26":0.0,"27":0.0825419211,"28":0.0833794484,"29":0.0182067846,"30":0.0893718747,"31":0.0057086027,"32":0.1440405022,"33":0.0,"34":0.0141229547,"35":0.10290062,"36":0.5965204869,"37":0.0941526927,"38":0.0004188657,"39":0.0247724612,"40":0.0558622787,"41":0.0367911454,"42":0.0214974069,"43":0.2238741993,"44":0.0235195802,"45":0.0238289924,"46":0.2706900643,"47":0.8582092481,"48":0.0378900453,"49":0.6283032145},"systemic_leverage":{"0":0.0010799723,"1":0.0495322624,"2":0.0071352094,"3":0.0539030259,"4":0.0670410521,"5":0.0117200423,"6":0.4128896127,"7":0.0191553466,"8":0.0399541655,"9":0.0,"10":0.0398831017,"11":0.0596959585,"12":0.0275594765,"13":0.044381746,"14":0.0539838646,"15":0.0314277345,"16":0.0217393535,"17":0.0988042803,"18":0.0423804591,"19":0.0,"20":0.0,"21":0.0808516751,"22":0.0938234565,"23":0.3235911859,"24":0.0560505011,"25":0.0585969426,"26":0.0,"27":0.0676843753,"28":0.0767090925,"29":0.0163861061,"30":0.0786472497,"31":0.0049093984,"32":0.1267556419,"33":0.0,"34":0.0135580365,"35":0.092610558,"36":0.5368684382,"37":0.0866204773,"38":0.0003686018,"39":0.0232861135,"40":0.0536277876,"41":0.0331120308,"42":0.0180578218,"43":0.1970092953,"44":0.0206972306,"45":0.0214460931,"46":0.2490348591,"47":0.7552241383,"48":0.0341010408,"49":0.5403407645},"num_of_rationed":{"0":6,"1":8,"2":3,"3":5,"4":6,"5":2,"6":1,"7":5,"8":4,"9":2,"10":3,"11":8,"12":7,"13":4,"14":2,"15":4,"16":3,"17":4,"18":1,"19":2,"20":4,"21":0,"22":3,"23":4,"24":4,"25":3,"26":5,"27":7,"28":3,"29":4,"30":3,"31":6,"32":2,"33":5,"34":1,"35":1,"36":4,"37":3,"38":9,"39":1,"40":0,"41":1,"42":5,"43":3,"44":7,"45":5,"46":2,"47":4,"48":6,"49":1},"loans":{"0":0.809979206,"1":10.3098158863,"2":5.3514070574,"3":20.2136347065,"4":13.0328402492,"5":6.8036750096,"6":8.4704289182,"7":13.4395359804,"8":10.9662793415,"9":12.6588176674,"10":15.4646370282,"11":10.1478178046,"12":20.6696073642,"13":8.8704959703,"14":12.2362154092,"15":17.1931373797,"16":6.9870128847,"17":16.6714224062,"18":15.8926721494,"19":13.9375911952,"20":2.3443098614,"21":13.2721381124,"22":9.2979939981,"23":7.4287501884,"24":9.7484359585,"25":8.9013570513,"26":null,"27":10.6410496,"28":11.704868081,"29":8.6361514113,"30":13.100855902,"31":1.8410243834,"32":8.3812827816,"33":10.5732057409,"34":2.9589244363,"35":10.0501372439,"36":16.3703617075,"37":6.1145199703,"38":0.3558032448,"39":25.2868258599,"40":7.6589101648,"41":7.8363137534,"42":13.1204510575,"43":11.4098166329,"44":5.0804089356,"45":10.073473225,"46":7.7273522036,"47":15.8054578006,"48":6.3732521596,"49":9.1515478686},"c":{"0":148.1983620516,"1":153.05421774,"2":149.5133218647,"3":159.1588492067,"4":154.4809537025,"5":157.2975330346,"6":162.0605856955,"7":163.6578864655,"8":161.5482655948,"9":166.323301917,"10":169.77429753,"11":169.9442522735,"12":173.1915337132,"13":182.3409454267,"14":183.6702403645,"15":176.6256652942,"16":181.493777085,"17":182.1831532072,"18":181.2155249654,"19":193.0982065725,"20":183.1967652878,"21":187.505452172,"22":179.0254754344,"23":173.447133904,"24":173.3926991488,"25":172.7076769528,"26":165.4956937576,"27":166.3175747047,"28":174.9756718819,"29":168.6452127644,"30":172.6083712843,"31":173.7232639765,"32":179.2626686146,"33":177.1613519051,"34":170.1723537844,"35":168.1952283593,"36":165.716769623,"37":172.4060645209,"38":173.2928581912,"39":173.8262267536,"40":166.8060597656,"41":167.2502081349,"42":160.467700784,"43":155.7604689008,"44":153.8719477655,"45":161.4275383603,"46":168.1533011699,"47":163.9565917734,"48":161.8551051656,"49":163.6549205919},"reserves":{"0":117.2543328542,"1":112.1795197496,"2":127.134647429,"3":118.6155022235,"4":108.1928208518,"5":125.5994546092,"6":122.2624582244,"7":119.4912926669,"8":120.0444564944,"9":121.0686904692,"10":122.7893132136,"11":128.2681546091,"12":131.3817699109,"13":152.3746963194,"14":150.3214204123,"15":134.1240516614,"16":147.9040107672,"17":135.0255328737,"18":152.7928851582,"19":162.89025283,"20":155.4335097416,"21":154.5377976964,"22":145.9912175902,"23":131.4545127841,"24":120.5888085216,"25":127.8546436291,"26":134.3612536346,"27":123.6968683052,"28":140.8828430077,"29":132.1752954059,"30":136.3280126165,"31":147.5401503029,"32":152.8170103884,"33":147.0818919238,"34":147.5743703838,"35":118.6470743205,"36":134.0496367239,"37":145.0003781784,"38":128.9825715605,"39":144.147201585,"40":136.734641219,"41":132.6012237743,"42":114.0349862173,"43":118.9148837247,"44":100.6668743235,"45":126.3198214446,"46":143.9162781812,"47":124.3165111121,"48":127.7268214175,"49":120.0051928645},"deposits":{"0":5862.7166427119,"1":5608.9759874822,"2":6356.7323714503,"3":5930.7751111744,"4":5409.6410425909,"5":6279.9727304588,"6":6113.1229112203,"7":5974.5646333444,"8":6002.2228247193,"9":6053.4345234582,"10":6139.4656606813,"11":6413.4077304529,"12":6569.0884955441,"13":7618.7348159675,"14":7516.0710206161,"15":6706.2025830686,"16":7395.2005383598,"17":6751.2766436835,"18":7639.6442579105,"19":8144.5126414995,"20":7771.6754870814,"21":7726.8898848202,"22":7299.5608795115,"23":6572.7256392072,"24":6029.4404260814,"25":6392.7321814575,"26":6718.0626817303,"27":6184.8434152589,"28":7044.1421503857,"29":6608.7647702927,"30":6816.4006308269,"31":7377.0075151446,"32":7640.85051942,"33":7354.0945961911,"34":7378.7185191883,"35":5932.3537160256,"36":6702.4818361946,"37":7250.0189089195,"38":6449.128578027,"39":7207.3600792492,"40":6836.73206095,"41":6630.0611887137,"42":5701.7493108628,"43":5945.744186235,"44":5033.3437161773,"45":6315.9910722292,"46":7195.8139090593,"47":6215.8255556031,"48":6386.3410708738,"49":6000.2596432235},"psi":{"0":1.0,"1":0.9538680348,"2":0.6963397301,"3":0.7151459111,"4":0.7082325946,"5":0.8449542542,"6":0.5336886436,"7":0.6083697018,"8":0.6163835808,"9":0.6270775427,"10":0.85446682,"11":0.8776499828,"12":0.875594555,"13":0.881327833,"14":0.8575097797,"15":0.84552196,"16":0.8947811878,"17":0.7642318549,"18":0.7916670653,"19":0.805808889,"20":0.7880558125,"21":0.7752241729,"22":0.7119096575,"23":0.7901619318,"24":0.771867177,"25":0.7681982395,"26":0.7364559008,"27":0.8150409289,"28":0.8034418675,"29":0.8190827018,"30":0.798382939,"31":0.5624763659,"32":0.5914142847,"33":0.5814756694,"34":0.5512592072,"35":0.5595143269,"36":0.5860884517,"37":0.5987720421,"38":0.5928187337,"39":0.605010911,"40":0.5739356693,"41":0.5795330972,"42":0.5661131446,"43":0.6002686519,"44":0.5879350039,"45":0.5910076162,"46":0.5713338556,"47":0.5390931446,"48":0.5183462386,"49":0.5252358771},"psi_lenders":{"0":1.0,"1":1.0,"2":0.1730941395,"3":0.4484854737,"4":0.6618218492,"5":1.0,"6":0.5830317891,"7":0.4299928953,"8":0.5202604557,"9":0.7264696249,"10":1.0,"11":1.0,"12":1.0,"13":1.0,"14":0.933870492,"15":0.6510150647,"16":0.6207800996,"17":0.6966275555,"18":0.8447670149,"19":0.8447670149,"20":0.8447670149,"21":0.8447670149,"22":0.7704616392,"23":0.8447670149,"24":0.8273451431,"25":0.8132377049,"26":0.0,"27":1.0,"28":0.8125877713,"29":0.844857619,"30":0.9096576984,"31":0.5227339134,"32":0.6879396941,"33":0.6599742468,"34":0.4989010916,"35":0.5957993514,"36":0.642309747,"37":0.6599742468,"38":0.0462115382,"39":0.6599742468,"40":0.50762587,"41":0.6599742468,"42":0.5642089832,"43":0.5851475065,"44":0.6780821176,"45":0.5754292968,"46":0.7027019662,"47":0.7925966147,"48":0.6599742468,"49":0.630448873},"potential_lenders":{"0":21,"1":21,"2":17,"3":23,"4":21,"5":29,"6":29,"7":25,"8":18,"9":24,"10":21,"11":18,"12":22,"13":27,"14":22,"15":19,"16":25,"17":21,"18":26,"19":29,"20":24,"21":25,"22":24,"23":18,"24":20,"25":26,"26":18,"27":19,"28":23,"29":22,"30":21,"31":21,"32":26,"33":20,"34":23,"35":25,"36":22,"37":25,"38":18,"39":27,"40":26,"41":27,"42":18,"43":24,"44":19,"45":24,"46":28,"47":21,"48":22,"49":25},"active_lenders":{"0":1,"1":3,"2":1,"3":1,"4":5,"5":2,"6":5,"7":4,"8":6,"9":2,"10":3,"11":1,"12":1,"13":2,"14":4,"15":2,"16":4,"17":3,"18":1,"19":1,"20":1,"21":3,"22":4,"23":2,"24":4,"25":5,"26":0,"27":3,"28":3,"29":2,"30":4,"31":2,"32":3,"33":1,"34":2,"35":4,"36":2,"37":2,"38":1,"39":1,"40":2,"41":4,"42":3,"43":4,"44":2,"45":2,"46":4,"47":2,"48":2,"49":5},"active_borrowers":{"0":1,"1":4,"2":1,"3":1,"4":5,"5":2,"6":5,"7":4,"8":8,"9":2,"10":3,"11":2,"12":1,"13":2,"14":4,"15":2,"16":4,"17":3,"18":1,"19":1,"20":1,"21":3,"22":4,"23":2,"24":4,"25":5,"26":0,"27":4,"28":3,"29":2,"30":4,"31":2,"32":4,"33":1,"34":2,"35":4,"36":2,"37":2,"38":1,"39":2,"40":2,"41":4,"42":3,"43":4,"44":2,"45":2,"46":4,"47":3,"48":2,"49":6},"prob_bankruptcy":{"0":0.0,"1":0.2981510082,"2":0.9469063734,"3":0.2280777806,"4":0.1058171808,"5":0.5542257245,"6":0.317200697,"7":0.2735303751,"8":0.4183857248,"9":0.0,"10":0.0,"11":0.0,"12":0.0,"13":0.0,"14":0.0,"15":0.0,"16":0.351075248,"17":0.1552329851,"18":0.1552329851,"19":0.1552329851,"20":0.1552329851,"21":0.3060511478,"22":0.1552329851,"23":0.1552329851,"24":0.1552329851,"25":0.1552329851,"26":null,"27":0.1498896563,"28":0.0903423016,"29":0.3081522853,"30":0.4250321915,"31":0.5629705933,"32":0.4885744328,"33":0.3400257532,"34":0.2319964535,"35":0.3400257532,"36":0.5094902429,"37":0.4030816839,"38":0.6735290561,"39":0.3400257532,"40":0.4118109813,"41":0.5001201039,"42":0.414371009,"43":0.4235276971,"44":0.425481192,"45":0.3487738786,"46":0.4321587675,"47":0.3400257532,"48":0.3400257532,"49":0.3699669977},"num_banks":{"0":50,"1":50,"2":50,"3":50,"4":50,"5":50,"6":50,"7":50,"8":50,"9":50,"10":50,"11":50,"12":50,"13":50,"14":50,"15":50,"16":50,"17":50,"18":50,"19":50,"20":50,"21":50,"22":50,"23":50,"24":50,"25":50,"26":50,"27":50,"28":50,"29":50,"30":50,"31":50,"32":50,"33":50,"34":50,"35":50,"36":50,"37":50,"38":50,"39":50,"40":50,"41":50,"42":50,"43":50,"44":50,"45":50,"46":50,"47":50,"48":50,"49":50},"bankruptcy_rationed":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0},"grade_avg":{"0":2.1739130435,"1":2.2727272727,"2":2.380952381,"3":1.6666666667,"4":2.0833333333,"5":1.6666666667,"6":2.0833333333,"7":1.8518518519,"8":2.1739130435,"9":2.0,"10":1.9230769231,"11":1.8518518519,"12":1.7857142857,"13":2.0,"14":2.0,"15":2.0833333333,"16":2.0833333333,"17":2.2727272727,"18":1.9230769231,"19":1.724137931,"20":2.380952381,"21":1.9230769231,"22":1.9230769231,"23":1.8518518519,"24":1.8518518519,"25":1.9230769231,"26":2.0,"27":2.0,"28":1.6129032258,"29":1.8518518519,"30":1.7857142857,"31":2.6315789474,"32":1.9230769231,"33":2.0,"34":1.7857142857,"35":2.1739130435,"36":2.1739130435,"37":1.6666666667,"38":1.724137931,"39":2.0,"40":2.2727272727,"41":2.1739130435,"42":2.380952381,"43":1.7857142857,"44":2.380952381,"45":2.380952381,"46":1.9230769231,"47":2.0,"48":2.0833333333,"49":2.6315789474},"communities":{"0":23,"1":22,"2":21,"3":30,"4":24,"5":30,"6":24,"7":27,"8":23,"9":25,"10":26,"11":27,"12":28,"13":25,"14":25,"15":24,"16":24,"17":22,"18":26,"19":29,"20":21,"21":26,"22":26,"23":27,"24":27,"25":26,"26":25,"27":25,"28":31,"29":27,"30":28,"31":19,"32":26,"33":25,"34":28,"35":23,"36":23,"37":30,"38":29,"39":25,"40":22,"41":23,"42":21,"43":28,"44":21,"45":21,"46":26,"47":25,"48":24,"49":19},"communities_not_alone":{"0":7,"1":11,"2":13,"3":10,"4":12,"5":12,"6":11,"7":11,"8":10,"9":11,"10":10,"11":10,"12":11,"13":11,"14":14,"15":12,"16":11,"17":9,"18":12,"19":10,"20":9,"21":10,"22":8,"23":11,"24":7,"25":11,"26":12,"27":11,"28":11,"29":13,"30":11,"31":10,"32":13,"33":11,"34":11,"35":12,"36":12,"37":9,"38":9,"39":11,"40":10,"41":12,"42":12,"43":9,"44":10,"45":7,"46":12,"47":9,"48":11,"49":11},"gcs":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0}}'
    maxDiff = None

    def setUp(self):
        model = interbank.Model()
        model.config.lender_change = self.ALGORITHM()
        model.log.define_log('ERROR')
        model.config.lender_change.set_parameter("p", self.P)
        model.configure_json(self.CONFIG)
        model.configure(N=self.N, T=self.T)
        model.initialize(seed=self.SEED, output_directory='tests',
                         export_datafile='test_whole_execution_shockedmarket')
        model.simulate_full()
        self.generated_now_values = model.finish()

    def test_values_after_execution(self):
        self.assertEqual(self.generated_now_values.to_json(), self.RESULTS_TO_COMPARE)


if __name__ == '__main__':
    unittest.main()
