# -*- coding: utf-8 -*-

import unittest
import interbank
import interbank_lenderchange
import os


class WholeExecution(unittest.TestCase):
    N = 50
    T = 50

    ALGORITHM = interbank_lenderchange.RestrictedMarket
    P = 0.5

    SEED = 39393

    CONFIG = 'C_i0=30 D_i0=135 E_i0=15 L_i0=120 alfa=0.1 allow_replacement_of_bankrupted=True beta=5 chi=0.0015 mu=0.7 normalize_interest_rate_max=1 omega=0.55 phi=0.25 psi=0.0 r_i0=0.02 reintroduce_with_median=False reserves=0.02 rho=0.3 xi=0.9 '

    RESULTS_TO_COMPARE = '{"bad_debt":{"0":0.809979206,"1":11.1739594398,"2":29.2915192722,"3":0.2942748792,"4":14.1296760108,"5":5.4057825216,"6":8.0427148189,"7":1.7983122264,"8":19.7881611874,"9":0.0,"10":27.1733702811,"11":19.3275916814,"12":0.0,"13":0.0,"14":0.0,"15":17.2201460573,"16":16.1908436689,"17":11.5514877204,"18":15.221018113,"19":0.0,"20":14.2528468603,"21":26.5774744702,"22":0.0,"23":0.0,"24":0.0,"25":0.0,"26":16.6290843769,"27":0.0,"28":0.0,"29":24.9474162678,"30":16.1366601474,"31":39.1623492454,"32":20.1489350241,"33":17.097371325,"34":6.2350950366,"35":9.4469137293,"36":0.6022342098,"37":13.0207350864,"38":24.3685863943,"39":12.9302847407,"40":22.6283078368,"41":0.0,"42":27.2984793719,"43":0.0,"44":13.2306855168,"45":21.5744955595,"46":7.5243677938,"47":15.2322474437,"48":12.8641446744,"49":11.9114618971},"active_borrowers":{"0":1,"1":2,"2":2,"3":1,"4":1,"5":1,"6":1,"7":3,"8":2,"9":1,"10":2,"11":2,"12":0,"13":0,"14":0,"15":3,"16":1,"17":1,"18":2,"19":0,"20":2,"21":2,"22":0,"23":2,"24":0,"25":1,"26":2,"27":0,"28":1,"29":1,"30":1,"31":2,"32":2,"33":2,"34":1,"35":1,"36":1,"37":2,"38":1,"39":2,"40":2,"41":0,"42":1,"43":1,"44":2,"45":2,"46":1,"47":2,"48":3,"49":1},"active_lenders":{"0":1,"1":2,"2":2,"3":1,"4":1,"5":1,"6":1,"7":3,"8":2,"9":1,"10":2,"11":2,"12":0,"13":0,"14":0,"15":3,"16":1,"17":1,"18":2,"19":0,"20":2,"21":2,"22":0,"23":2,"24":0,"25":1,"26":2,"27":0,"28":1,"29":1,"30":1,"31":2,"32":2,"33":2,"34":1,"35":1,"36":1,"37":2,"38":1,"39":2,"40":2,"41":0,"42":1,"43":1,"44":2,"45":2,"46":1,"47":2,"48":3,"49":1},"asset_i":{"0":0.0,"1":153.6124675246,"2":163.263093868,"3":156.0163236108,"4":157.9615509149,"5":181.5606082715,"6":172.8907567096,"7":163.8329752324,"8":169.8425573593,"9":183.4042508432,"10":162.6765260938,"11":182.1890633195,"12":180.1888715268,"13":175.6532643619,"14":162.4077243427,"15":182.8065891207,"16":168.5365946417,"17":180.2235611782,"18":185.6728473336,"19":168.9093287553,"20":189.6753053308,"21":186.0305705613,"22":176.7112555361,"23":199.8183301223,"24":191.7387772043,"25":195.756013278,"26":167.4421896236,"27":193.1484340529,"28":186.4418091555,"29":202.9247318158,"30":172.7439181547,"31":175.9639166391,"32":178.2417287081,"33":186.7887180667,"34":183.3117961816,"35":167.3225684558,"36":178.3730868993,"37":184.1806895684,"38":169.8772992231,"39":163.9419253233,"40":178.0509627718,"41":184.1151428199,"42":176.8866404951,"43":193.1395647497,"44":192.2169432083,"45":186.0824561028,"46":197.266472488,"47":209.4854147744,"48":210.0760947407,"49":203.1197654463},"asset_j":{"0":0.0,"1":151.2643618284,"2":158.1460008756,"3":164.5979274923,"4":165.8972732714,"5":172.0631869693,"6":168.9813517627,"7":166.1860669465,"8":164.7619184465,"9":169.1956160884,"10":174.2274389291,"11":175.6990238696,"12":178.6622769603,"13":178.0682164744,"14":180.7418742343,"15":179.1741754031,"16":177.6512417139,"17":178.8647872857,"18":178.0102366156,"19":175.611238018,"20":174.9899499631,"21":184.2216992961,"22":179.0176165662,"23":182.7399920292,"24":182.983631938,"25":182.033971937,"26":179.9866031595,"27":190.0389268366,"28":189.600229901,"29":187.1253094271,"30":181.7367277744,"31":172.3147834233,"32":180.0135772656,"33":179.3512156079,"34":175.5833641147,"35":171.2454811828,"36":174.3315670893,"37":180.9620047321,"38":182.2819898719,"39":173.9439613227,"40":168.6761958918,"41":175.2972331695,"42":184.5322974397,"43":190.9497563357,"44":192.5277470305,"45":196.0003087251,"46":192.5601154461,"47":199.5539670741,"48":206.8890909599,"49":195.2105326785},"bankruptcies":{"0":8,"1":16,"2":14,"3":9,"4":12,"5":14,"6":16,"7":15,"8":8,"9":7,"10":9,"11":16,"12":9,"13":11,"14":8,"15":10,"16":7,"17":8,"18":12,"19":11,"20":13,"21":10,"22":5,"23":8,"24":11,"25":8,"26":14,"27":6,"28":6,"29":12,"30":4,"31":13,"32":11,"33":10,"34":11,"35":10,"36":9,"37":10,"38":14,"39":10,"40":16,"41":6,"42":9,"43":4,"44":10,"45":9,"46":14,"47":9,"48":8,"49":9},"bankruptcy_rationed":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0},"best_lender":{"0":7,"1":7,"2":7,"3":7,"4":7,"5":7,"6":7,"7":7,"8":7,"9":7,"10":7,"11":7,"12":7,"13":7,"14":7,"15":7,"16":7,"17":7,"18":7,"19":7,"20":7,"21":7,"22":7,"23":7,"24":7,"25":7,"26":7,"27":7,"28":7,"29":7,"30":7,"31":7,"32":7,"33":7,"34":7,"35":7,"36":7,"37":7,"38":7,"39":7,"40":7,"41":7,"42":7,"43":7,"44":7,"45":7,"46":7,"47":7,"48":7,"49":7},"best_lender_clients":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":2,"9":2,"10":2,"11":2,"12":2,"13":2,"14":2,"15":2,"16":2,"17":2,"18":2,"19":2,"20":2,"21":2,"22":2,"23":2,"24":2,"25":2,"26":2,"27":2,"28":2,"29":2,"30":2,"31":2,"32":2,"33":2,"34":2,"35":2,"36":2,"37":2,"38":2,"39":2,"40":2,"41":2,"42":2,"43":2,"44":2,"45":2,"46":2,"47":2,"48":2,"49":2},"c":{"0":148.1983620516,"1":154.8786068762,"2":161.4430203349,"3":162.7867146835,"4":168.5040285735,"5":165.5281653639,"6":162.9031445977,"7":159.5771364513,"8":165.6028368358,"9":171.1003605057,"10":172.0896398123,"11":175.0665904809,"12":174.5368297505,"13":177.5680563916,"14":175.4957648166,"15":174.1805878595,"16":175.2597499064,"17":174.3171740021,"18":172.1498463862,"19":171.1903249584,"20":180.5128143607,"21":175.5482457261,"22":178.8124448039,"23":179.2783069454,"24":178.1915784905,"25":176.5092837018,"26":186.1692524356,"27":185.8676541477,"28":183.2029956186,"29":178.3183111666,"30":168.8052173989,"31":176.455926732,"32":175.6242472495,"33":171.9262786546,"34":167.9074896603,"35":170.7477188255,"36":177.2992568976,"37":178.818699027,"38":170.6532804056,"39":165.1401279389,"40":171.5608471339,"41":180.985512172,"42":187.078086363,"43":188.6830401746,"44":192.2522628568,"45":188.6504915584,"46":195.3760176126,"47":202.7150389815,"48":191.17023245,"49":199.8358203482},"deposits":{"0":5862.7166427119,"1":5264.4551407296,"2":5906.0449425135,"3":6460.239997605,"4":6304.7097626897,"5":5936.7103928258,"6":5565.5078408994,"7":5937.7892487185,"8":6737.1455811508,"9":7029.6746345825,"10":7115.3565090124,"11":6184.4068828973,"12":6947.8635367402,"13":6836.8760168475,"14":7161.7913331729,"15":7150.0816799555,"16":7444.5546488178,"17":7237.9384887186,"18":6704.5613277456,"19":6459.7565043089,"20":6956.2693153887,"21":7120.3289699878,"22":7659.2661572236,"23":7464.4215910388,"24":6792.913501059,"25":7337.2465902834,"26":7213.6398943301,"27":7885.7182968589,"28":7725.928858045,"29":6902.7147884541,"30":7371.8380278333,"31":6854.2185927327,"32":6913.3264989256,"33":6729.2472088249,"34":6370.563166842,"35":6773.8905315569,"36":7125.4169092071,"37":7077.1888978662,"38":6071.0479555989,"39":6474.8135415253,"40":5914.8711026927,"41":7616.2857737601,"42":7675.7588703518,"43":8235.4526420594,"44":7617.5784990715,"45":7860.4266919669,"46":7378.4687662573,"47":8448.0887608462,"48":8346.72033769,"49":8419.5763571105},"equity":{"0":610.4010260723,"1":476.3372784422,"2":475.0746049023,"3":556.6730377997,"4":524.9401927211,"5":469.8016882765,"6":435.7858850652,"7":479.4716411418,"8":531.6186444811,"9":517.3307193223,"10":500.6860935626,"11":413.6403491098,"12":510.0661687409,"13":474.9779138318,"14":526.8120922006,"15":524.0787497277,"16":511.3452056623,"17":500.5051534159,"18":491.5022608273,"19":491.077962023,"20":513.6329732659,"21":546.5509273845,"22":619.7325410134,"23":559.8440754091,"24":523.6113620236,"25":552.8205958662,"26":500.2154944211,"27":562.8901438291,"28":589.5996267311,"29":538.3158987691,"30":611.81074708,"31":505.9481398202,"32":518.7331049331,"33":487.1975305497,"34":499.3902217349,"35":538.7415999616,"36":544.3417776939,"37":542.1936536353,"38":490.3693191154,"39":558.4766234986,"40":473.3623812743,"41":609.6755536724,"42":581.435716179,"43":609.2133570554,"44":557.1812117307,"45":608.7444975437,"46":513.3938182489,"47":588.5883894094,"48":585.7095041674,"49":571.7101612235},"fitness":{"0":0.0,"1":0.3812910383,"2":0.2883542115,"3":0.2427894797,"4":0.2029394908,"5":0.1502886775,"6":0.1606139806,"7":0.1741468757,"8":0.1038462864,"9":0.104552364,"10":0.0957052518,"11":0.1281002877,"12":0.1071979331,"13":0.1192117946,"14":0.1491315891,"15":0.1418961168,"16":0.2445830299,"17":0.270811748,"18":0.2341330566,"19":0.2017780376,"20":0.2474173194,"21":0.1994923437,"22":0.2065258197,"23":0.2879155021,"24":0.2398256649,"25":0.202222106,"26":0.1620587834,"27":0.143686092,"28":0.2076679925,"29":0.2744263828,"30":0.1837770589,"31":0.2710364465,"32":0.2607278859,"33":0.1976389645,"34":0.1902544099,"35":0.1933627313,"36":0.2212266105,"37":0.2075791664,"38":0.1861979516,"39":0.2381606417,"40":0.3182975626,"41":0.215426711,"42":0.1948470873,"43":0.1807592236,"44":0.235088095,"45":0.2507874787,"46":0.2161255304,"47":0.155219854,"48":0.1732482295,"49":0.2365689743},"incrementD":{"0":-235.4690351297,"1":-242.5662753515,"2":-119.952752697,"3":-333.8845144637,"4":-181.4668939826,"5":-696.4184377139,"6":-845.0781792553,"7":-451.3900768065,"8":-231.6091064587,"9":-78.0809357218,"10":-299.4597557304,"11":-430.32548252,"12":-462.4505714533,"13":-362.3451823914,"14":-431.0971636397,"15":-245.7228756658,"16":-363.5495848411,"17":-406.0484255988,"18":-327.682231904,"19":-703.9535966347,"20":40.3916932058,"21":-364.9411215016,"22":-244.1486898866,"23":-166.4841751014,"24":-730.7470200099,"25":-218.9259787469,"26":-216.6704605434,"27":-282.1015746878,"28":-409.1933068249,"29":-650.3103951913,"30":-515.0045834379,"31":109.8128926832,"32":-404.7255236325,"33":-540.6306617916,"34":-647.4579054479,"35":-238.3366816846,"36":-40.3846978224,"37":-297.0899933829,"38":-1039.3533895279,"39":-699.6103725469,"40":-244.5587811668,"41":187.2542052324,"42":-39.2601050757,"43":-154.9193900178,"44":-235.9931857064,"45":-420.1930506483,"46":-227.6324519931,"47":161.8477489164,"48":-589.666077375,"49":-228.2828993574},"interest_rate":{"0":1.0,"1":1.0,"2":1.0,"3":1.0,"4":1.0,"5":1.0,"6":1.0,"7":1.0,"8":1.0,"9":1.0,"10":1.0,"11":1.0,"12":1.0,"13":1.0,"14":1.0,"15":1.0,"16":1.0,"17":1.0,"18":1.0,"19":1.0,"20":1.0,"21":1.0,"22":1.0,"23":1.0,"24":1.0,"25":1.0,"26":1.0,"27":1.0,"28":1.0,"29":1.0,"30":1.0,"31":1.0,"32":1.0,"33":1.0,"34":1.0,"35":1.0,"36":1.0,"37":1.0,"38":1.0,"39":1.0,"40":1.0,"41":1.0,"42":1.0,"43":1.0,"44":1.0,"45":1.0,"46":1.0,"47":1.0,"48":1.0,"49":1.0},"leverage":{"0":0.0011489067,"1":0.0338604832,"2":0.0,"3":0.0004174112,"4":0.0,"5":0.0,"6":0.0,"7":0.0226514977,"8":0.0280683137,"9":0.0,"10":0.0,"11":0.0,"12":0.0,"13":0.0,"14":0.0,"15":0.0058296736,"16":0.0234649908,"17":0.0,"18":0.0225496565,"19":0.0,"20":0.0171051899,"21":0.0009091465,"22":0.0,"23":0.0118525262,"24":0.0,"25":0.0011411787,"26":0.0246858788,"27":0.0,"28":0.0,"29":0.0423799002,"30":0.0219546397,"31":0.033182501,"32":0.0003293149,"33":0.0566681395,"34":0.0,"35":0.0,"36":0.0017084658,"37":0.0,"38":0.0,"39":0.0121180688,"40":0.0479053524,"41":0.0,"42":0.0,"43":0.0,"44":0.0,"45":0.0469497066,"46":0.0119434409,"47":0.0216060247,"48":0.0170253112,"49":0.0},"liquidity":{"0":1282.156580603,"1":1466.4702676972,"2":1876.6812152104,"3":2022.8778514016,"4":2225.2723385663,"5":2050.1492862738,"6":1858.3113682002,"7":1986.4341980223,"8":2254.1177802742,"9":2549.1644223875,"10":2587.7656433637,"11":2483.4701958946,"12":2611.9927117896,"13":2716.1358182364,"14":2688.6015518622,"15":2758.1685111859,"16":2793.1114501039,"17":2713.2103834403,"18":2587.9552822199,"19":2415.9568558948,"20":2842.8878309613,"21":2787.6874999988,"22":2894.618648917,"23":3052.822861718,"24":2709.0133907284,"25":2980.2270685133,"26":3144.1747728514,"27":3282.9531807554,"28":3112.0405996114,"29":2748.2377686556,"30":2508.5007364983,"31":2700.4277341983,"32":2689.7281303029,"33":2554.0221289115,"34":2287.3088532454,"35":2470.7928454878,"36":2789.1638759816,"37":2800.6901209316,"38":2291.1314768976,"39":2143.1477487458,"40":2244.3864207419,"41":2965.599632734,"42":3212.9904295906,"43":3445.1815338668,"44":3419.1173240033,"45":3307.2496577495,"46":3476.922631378,"47":3998.5655128122,"48":3827.79592969,"49":3896.8174949477},"loans":{"0":0.809979206,"1":11.9144868998,"2":29.2915192722,"3":0.2942748792,"4":14.1296760108,"5":5.4057825216,"6":8.0427148189,"7":7.232674526,"8":23.0611065204,"9":3.4177416372,"10":27.1733702811,"11":22.4470114095,"12":0.0,"13":0.0,"14":0.0,"15":22.7397629268,"16":16.1908436689,"17":11.5514877204,"18":16.8457735083,"19":0.0,"20":14.2528468603,"21":27.1911483891,"22":0.0,"23":10.8175316869,"24":0.0,"25":0.6593225827,"26":16.6290843769,"27":0.0,"28":3.0127295476,"29":21.9346867202,"30":16.1366601474,"31":39.1623492454,"32":20.1489350241,"33":18.8993838385,"34":6.2350950366,"35":9.4469137293,"36":0.6022342098,"37":15.6762988793,"38":24.3685863943,"39":12.9302847407,"40":43.9818339859,"41":0.0,"42":27.2984793719,"43":0.0193234588,"44":27.4992402077,"45":21.5744955595,"46":7.5243677938,"47":16.8710182531,"48":21.3036283079,"49":8.8076327639},"num_banks":{"0":50,"1":50,"2":50,"3":50,"4":50,"5":50,"6":50,"7":50,"8":50,"9":50,"10":50,"11":50,"12":50,"13":50,"14":50,"15":50,"16":50,"17":50,"18":50,"19":50,"20":50,"21":50,"22":50,"23":50,"24":50,"25":50,"26":50,"27":50,"28":50,"29":50,"30":50,"31":50,"32":50,"33":50,"34":50,"35":50,"36":50,"37":50,"38":50,"39":50,"40":50,"41":50,"42":50,"43":50,"44":50,"45":50,"46":50,"47":50,"48":50,"49":50},"num_loans":{"0":1,"1":2,"2":2,"3":1,"4":1,"5":1,"6":1,"7":3,"8":2,"9":1,"10":2,"11":2,"12":0,"13":0,"14":0,"15":3,"16":1,"17":1,"18":2,"19":0,"20":2,"21":2,"22":0,"23":2,"24":0,"25":1,"26":2,"27":0,"28":1,"29":1,"30":1,"31":2,"32":2,"33":2,"34":1,"35":1,"36":1,"37":2,"38":1,"39":2,"40":2,"41":0,"42":1,"43":1,"44":2,"45":2,"46":1,"47":2,"48":3,"49":1},"num_of_rationed":{"0":6,"1":6,"2":7,"3":3,"4":2,"5":10,"6":11,"7":9,"8":3,"9":6,"10":2,"11":11,"12":5,"13":8,"14":6,"15":5,"16":7,"17":5,"18":6,"19":8,"20":4,"21":7,"22":5,"23":6,"24":6,"25":4,"26":3,"27":5,"28":3,"29":7,"30":2,"31":5,"32":4,"33":6,"34":5,"35":5,"36":2,"37":4,"38":5,"39":2,"40":8,"41":3,"42":4,"43":3,"44":5,"45":4,"46":9,"47":2,"48":4,"49":7},"policy":{"0":1.0,"1":1.0,"2":1.0,"3":1.0,"4":1.0,"5":1.0,"6":1.0,"7":1.0,"8":1.0,"9":1.0,"10":1.0,"11":1.0,"12":1.0,"13":1.0,"14":1.0,"15":1.0,"16":1.0,"17":1.0,"18":1.0,"19":1.0,"20":1.0,"21":1.0,"22":1.0,"23":1.0,"24":1.0,"25":1.0,"26":1.0,"27":1.0,"28":1.0,"29":1.0,"30":1.0,"31":1.0,"32":1.0,"33":1.0,"34":1.0,"35":1.0,"36":1.0,"37":1.0,"38":1.0,"39":1.0,"40":1.0,"41":1.0,"42":1.0,"43":1.0,"44":1.0,"45":1.0,"46":1.0,"47":1.0,"48":1.0,"49":1.0},"potential_credit_channels":{"0":20,"1":20,"2":20,"3":20,"4":20,"5":20,"6":20,"7":20,"8":20,"9":20,"10":20,"11":20,"12":20,"13":20,"14":20,"15":20,"16":20,"17":20,"18":20,"19":20,"20":20,"21":20,"22":20,"23":20,"24":20,"25":20,"26":20,"27":20,"28":20,"29":20,"30":20,"31":20,"32":20,"33":20,"34":20,"35":20,"36":20,"37":20,"38":20,"39":20,"40":20,"41":20,"42":20,"43":20,"44":20,"45":20,"46":20,"47":20,"48":20,"49":20},"potential_lenders":{"0":21,"1":23,"2":25,"3":22,"4":28,"5":19,"6":24,"7":23,"8":29,"9":21,"10":30,"11":21,"12":21,"13":19,"14":27,"15":28,"16":21,"17":25,"18":23,"19":22,"20":25,"21":20,"22":29,"23":22,"24":21,"25":21,"26":20,"27":26,"28":24,"29":18,"30":27,"31":23,"32":27,"33":24,"34":24,"35":26,"36":27,"37":20,"38":21,"39":24,"40":23,"41":28,"42":24,"43":27,"44":24,"45":23,"46":19,"47":24,"48":18,"49":21},"prob_bankruptcy":{"0":0.0461319652,"1":0.1279361125,"2":0.1265671935,"3":0.0977692829,"4":0.080079743,"5":0.113597749,"6":0.1189521532,"7":0.3398652414,"8":0.3769136172,"9":0.3908978316,"10":0.1924185419,"11":0.2950763781,"12":0.2879836348,"13":0.29359999,"14":0.2860565052,"15":0.3038524241,"16":0.3362423138,"17":0.331650613,"18":0.2753606123,"19":0.2758289483,"20":0.2509329952,"21":0.1269819891,"22":0.1100972844,"23":0.3995604355,"24":0.24214545,"25":0.2595240538,"26":0.2678938848,"27":0.2814586087,"28":0.2520633587,"29":0.2424706236,"30":0.2771437699,"31":0.2780931165,"32":0.2805308838,"33":0.315237512,"34":0.2853104648,"35":0.2750187605,"36":0.2688554579,"37":0.254711264,"38":0.245713496,"39":0.2532992853,"40":0.2314139189,"41":0.2299687007,"42":0.2280315453,"43":0.1088635132,"44":0.5167638312,"45":0.5122789594,"46":0.5159352242,"47":0.5158022684,"48":0.5280193973,"49":0.3385340469},"profits":{"0":0.0,"1":11.9144868998,"2":11.5760908656,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":5.4343622996,"8":3.272945333,"9":3.4177416372,"10":0.0,"11":22.4470114095,"12":0.0,"13":0.0,"14":0.0,"15":22.7397629268,"16":0.0,"17":0.0,"18":16.8457735083,"19":0.0,"20":0.0,"21":0.613673919,"22":0.0,"23":10.8175316869,"24":0.0,"25":0.6593225827,"26":14.9874522595,"27":0.0,"28":3.0127295476,"29":0.0,"30":16.1366601474,"31":0.0,"32":19.9745267579,"33":0.0,"34":0.0,"35":0.0,"36":0.0,"37":2.6555637929,"38":0.0,"39":0.0,"40":0.0,"41":0.0,"42":0.0,"43":0.0193234588,"44":14.2685546909,"45":18.8649789244,"46":0.0,"47":1.6387708093,"48":8.4394836334,"49":0.0},"psi":{"0":1.0,"1":0.9538680348,"2":0.8720638875,"3":0.8734328065,"4":0.9022307171,"5":0.919920257,"6":0.886402251,"7":0.8810478468,"8":0.6601347586,"9":0.6230863828,"10":0.6091021684,"11":0.8075814581,"12":0.7049236219,"13":0.7120163652,"14":0.70640001,"15":0.7139434948,"16":0.6961475759,"17":0.6637576862,"18":0.668349387,"19":0.7246393877,"20":0.7241710517,"21":0.7490670048,"22":0.8730180109,"23":0.8899027156,"24":0.6004395645,"25":0.75785455,"26":0.7404759462,"27":0.7321061152,"28":0.7185413913,"29":0.7479366413,"30":0.7575293764,"31":0.7228562301,"32":0.7219068835,"33":0.7194691162,"34":0.684762488,"35":0.7146895352,"36":0.7249812395,"37":0.7311445421,"38":0.745288736,"39":0.754286504,"40":0.7467007147,"41":0.7685860811,"42":0.7700312993,"43":0.7719684547,"44":0.8911364868,"45":0.4832361688,"46":0.4877210406,"47":0.4840647758,"48":0.4841977316,"49":0.4719806027},"rationing":{"0":26.6145449151,"1":54.4111712614,"2":54.4798171342,"3":27.4147594126,"4":33.3559547751,"5":79.2146365257,"6":103.8917983686,"7":61.9687259031,"8":12.498677489,"9":76.8358338031,"10":13.8617993218,"11":81.7076747549,"12":17.036117869,"13":67.0710831161,"14":55.5084528638,"15":36.3436292137,"16":34.1245139725,"17":83.9983254568,"18":42.2386229226,"19":46.7603824572,"20":37.9062266572,"21":28.5009520709,"22":49.3023345643,"23":59.5344410476,"24":66.4417656671,"25":15.7345920582,"26":36.0435983201,"27":27.2894360577,"28":19.8458577318,"29":101.3860052378,"30":7.4975820025,"31":61.3580568767,"32":47.5125505894,"33":40.4179083235,"34":56.6621186138,"35":40.162809517,"36":25.4279676387,"37":30.3871510462,"38":37.4955540112,"39":13.6504528908,"40":108.2964520133,"41":51.8648189355,"42":17.8183437967,"43":15.6021472291,"44":50.5814350499,"45":24.6014759216,"46":95.2748677032,"47":12.99811551,"48":43.0272327132,"49":62.1650596122},"reserves":{"0":117.2543328542,"1":105.2891028146,"2":118.1208988503,"3":129.2047999521,"4":126.0941952538,"5":118.7342078565,"6":111.310156818,"7":118.7557849744,"8":134.742911623,"9":140.5934926916,"10":142.3071301802,"11":123.6881376579,"12":138.9572707348,"13":136.7375203369,"14":143.2358266635,"15":143.0016335991,"16":148.8910929764,"17":144.7587697744,"18":134.0912265549,"19":129.1951300862,"20":139.1253863078,"21":142.4065793998,"22":153.1853231445,"23":149.2884318208,"24":135.8582700212,"25":146.7449318057,"26":144.2727978866,"27":157.7143659372,"28":154.5185771609,"29":138.0542957691,"30":147.4367605567,"31":137.0843718547,"32":138.2665299785,"33":134.5849441765,"34":127.4112633368,"35":135.4778106311,"36":142.5083381841,"37":141.5437779573,"38":121.420959112,"39":129.4962708305,"40":118.2974220539,"41":152.3257154752,"42":153.515177407,"43":164.7090528412,"44":152.3515699814,"45":157.2085338393,"46":147.5693753251,"47":168.9617752169,"48":166.9344067538,"49":168.3915271422},"systemic_leverage":{"0":0.0010799723,"1":0.0297972252,"2":0.0,"3":0.0003923665,"4":0.0,"5":0.0,"6":0.0,"7":0.0185742281,"8":0.0263842149,"9":0.0,"10":0.0,"11":0.0,"12":0.0,"13":0.0,"14":0.0,"15":0.0052467062,"16":0.0215877916,"17":0.0,"18":0.0202946908,"19":0.0,"20":0.0150525671,"21":0.0008182319,"22":0.0,"23":0.0101931725,"24":0.0,"25":0.0010955316,"26":0.0227110085,"27":0.0,"28":0.0,"29":0.0364467141,"30":0.0215155469,"31":0.0305279009,"32":0.0002897971,"33":0.0510013256,"34":0.0,"35":0.0,"36":0.0016059579,"37":0.0,"38":0.0,"39":0.0113909846,"40":0.040240496,"41":0.0,"42":0.0,"43":0.0,"44":0.0,"45":0.0441327242,"46":0.0100324904,"47":0.0203096633,"48":0.0153227801,"49":0.0},"grade_avg":{"0":1.6666666667,"1":1.6666666667,"2":1.6666666667,"3":1.6666666667,"4":1.6666666667,"5":1.6666666667,"6":1.6666666667,"7":1.6666666667,"8":1.6666666667,"9":1.6666666667,"10":1.6666666667,"11":1.6666666667,"12":1.6666666667,"13":1.6666666667,"14":1.6666666667,"15":1.6666666667,"16":1.6666666667,"17":1.6666666667,"18":1.6666666667,"19":1.6666666667,"20":1.6666666667,"21":1.6666666667,"22":1.6666666667,"23":1.6666666667,"24":1.6666666667,"25":1.6666666667,"26":1.6666666667,"27":1.6666666667,"28":1.6666666667,"29":1.6666666667,"30":1.6666666667,"31":1.6666666667,"32":1.6666666667,"33":1.6666666667,"34":1.6666666667,"35":1.6666666667,"36":1.6666666667,"37":1.6666666667,"38":1.6666666667,"39":1.6666666667,"40":1.6666666667,"41":1.6666666667,"42":1.6666666667,"43":1.6666666667,"44":1.6666666667,"45":1.6666666667,"46":1.6666666667,"47":1.6666666667,"48":1.6666666667,"49":1.6666666667},"communities":{"0":30,"1":30,"2":30,"3":30,"4":30,"5":30,"6":30,"7":30,"8":30,"9":30,"10":30,"11":30,"12":30,"13":30,"14":30,"15":30,"16":30,"17":30,"18":30,"19":30,"20":30,"21":30,"22":30,"23":30,"24":30,"25":30,"26":30,"27":30,"28":30,"29":30,"30":30,"31":30,"32":30,"33":30,"34":30,"35":30,"36":30,"37":30,"38":30,"39":30,"40":30,"41":30,"42":30,"43":30,"44":30,"45":30,"46":30,"47":30,"48":30,"49":30},"communities_not_alone":{"0":8,"1":8,"2":8,"3":8,"4":8,"5":8,"6":8,"7":8,"8":8,"9":8,"10":8,"11":8,"12":8,"13":8,"14":8,"15":8,"16":8,"17":8,"18":8,"19":8,"20":8,"21":8,"22":8,"23":8,"24":8,"25":8,"26":8,"27":8,"28":8,"29":8,"30":8,"31":8,"32":8,"33":8,"34":8,"35":8,"36":8,"37":8,"38":8,"39":8,"40":8,"41":8,"42":8,"43":8,"44":8,"45":8,"46":8,"47":8,"48":8,"49":8},"gcs":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0}}'
    maxDiff = None

    def setUp(self):
        model = interbank.ModelOptimized()
        model.config.lender_change = self.ALGORITHM()
        model.log.define_log('ERROR')
        model.config.lender_change.set_parameter("p", self.P)
        model.configure_json(self.CONFIG)
        model.configure(N=self.N, T=self.T)
        model.initialize(seed=self.SEED, output_directory='tests',
                         export_datafile='test_whole_execution_restrictedmarket')
        model.simulate_full()
        self.generated_now_values = model.finish()
        if os.path.exists('tests\\test_whole_execution_restrictedmarket_erdos_renyi_0.json'):
            os.remove('tests\\test_whole_execution_restrictedmarket_erdos_renyi_0.json')
        if os.path.exists('tests\\test_whole_execution_restrictedmarket_erdos_renyi_0.png'):
            os.remove('tests\\test_whole_execution_restrictedmarket_erdos_renyi_0.png')


    def test_values_after_execution(self):
        self.assertEqual(self.generated_now_values.to_json(), self.RESULTS_TO_COMPARE)


if __name__ == '__main__':
    unittest.main()
